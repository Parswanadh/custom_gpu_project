#! /c/Source/iverilog-install/bin/vvp
:ivl_version "12.0 (devel)" "(s20150603-1539-g2693dd32b)";
:ivl_delay_selection "TYPICAL";
:vpi_time_precision - 12;
:vpi_module "D:\Tools\iverilog\lib\ivl\system.vpi";
:vpi_module "D:\Tools\iverilog\lib\ivl\vhdl_sys.vpi";
:vpi_module "D:\Tools\iverilog\lib\ivl\vhdl_textio.vpi";
:vpi_module "D:\Tools\iverilog\lib\ivl\v2005_math.vpi";
:vpi_module "D:\Tools\iverilog\lib\ivl\va_math.vpi";
S_000001fa49bdc350 .scope module, "gelu_activation" "gelu_activation" 2 11;
 .timescale 0 0;
    .port_info 0 /INPUT 1 "clk";
    .port_info 1 /INPUT 1 "rst";
    .port_info 2 /INPUT 1 "valid_in";
    .port_info 3 /INPUT 16 "x_in";
    .port_info 4 /OUTPUT 16 "y_out";
    .port_info 5 /OUTPUT 1 "valid_out";
P_000001fa49bc6f30 .param/l "HALF" 1 2 25, +C4<0000000010000000>;
P_000001fa49bc6f68 .param/l "NEG_THREE" 1 2 23, +C4<1111110100000000>;
P_000001fa49bc6fa0 .param/l "POS_THREE" 1 2 24, +C4<0000001100000000>;
P_000001fa49bc6fd8 .param/l "SLOPE" 1 2 27, +C4<0000000000101011>;
P_000001fa49bc7010 .param/l "WIDTH" 0 2 12, +C4<00000000000000000000000000010000>;
o000001fa49c3b0c8 .functor BUFZ 1, C4<z>; HiZ drive
v000001fa49bf20b0_0 .net "clk", 0 0, o000001fa49c3b0c8;  0 drivers
v000001fa49bf26f0_0 .var/s "full_product", 31 0;
o000001fa49c3b128 .functor BUFZ 1, C4<z>; HiZ drive
v000001fa49bf1bb0_0 .net "rst", 0 0, o000001fa49c3b128;  0 drivers
v000001fa49bf2790_0 .var/s "sigmoid_approx", 15 0;
v000001fa49bf1e30_0 .var/s "slope_x", 31 0;
o000001fa49c3b1b8 .functor BUFZ 1, C4<z>; HiZ drive
v000001fa49bf1c50_0 .net "valid_in", 0 0, o000001fa49c3b1b8;  0 drivers
v000001fa49bf21f0_0 .var "valid_out", 0 0;
o000001fa49c3b218 .functor BUFZ 16, C4<zzzzzzzzzzzzzzzz>; HiZ drive
v000001fa49bf2290_0 .net/s "x_in", 15 0, o000001fa49c3b218;  0 drivers
v000001fa49bf2330_0 .var/s "y_out", 15 0;
E_000001fa49c2cf00 .event posedge, v000001fa49bf20b0_0;
S_000001fa49c1b900 .scope module, "gpt2_demo_tb" "gpt2_demo_tb" 3 7;
 .timescale -9 -12;
P_000001fa49c12f80 .param/l "DW" 0 3 16, +C4<00000000000000000000000000010000>;
P_000001fa49c12fb8 .param/l "ED" 0 3 11, +C4<00000000000000000000000000000100>;
P_000001fa49c12ff0 .param/l "FD" 0 3 14, +C4<00000000000000000000000000001000>;
P_000001fa49c13028 .param/l "HD" 0 3 13, +C4<00000000000000000000000000000010>;
P_000001fa49c13060 .param/l "MS" 0 3 10, +C4<00000000000000000000000000001000>;
P_000001fa49c13098 .param/l "NH" 0 3 12, +C4<00000000000000000000000000000010>;
P_000001fa49c130d0 .param/l "NL" 0 3 15, +C4<00000000000000000000000000000010>;
P_000001fa49c13108 .param/l "VS" 0 3 9, +C4<00000000000000000000000000010000>;
v000001fa49c9fb90_0 .var "clk", 0 0;
v000001fa49c9e510_0 .var "ffn_b1_flat", 127 0;
v000001fa49c9e8d0_0 .var "ffn_b2_flat", 63 0;
v000001fa49c9e970_0 .var "ffn_w1_flat", 511 0;
v000001fa49c9ea10_0 .var "ffn_w2_flat", 511 0;
v000001fa49c9eb50_0 .var/i "ii", 31 0;
v000001fa49c9f190_0 .var "ln1_beta", 63 0;
v000001fa49c9f230_0 .var "ln1_gamma", 63 0;
v000001fa49ca19c0_0 .var "ln2_beta", 63 0;
v000001fa49ca1600_0 .var "ln2_gamma", 63 0;
v000001fa49ca1ce0_0 .var "ln_final_beta", 63 0;
v000001fa49ca1920_0 .var "ln_final_gamma", 63 0;
v000001fa49ca11a0_0 .var "load_dim_idx", 1 0;
v000001fa49ca1ec0_0 .var/s "load_emb_data", 15 0;
v000001fa49ca1060_0 .var "load_pos_emb", 0 0;
v000001fa49ca2000_0 .var "load_pos_idx", 2 0;
v000001fa49ca1d80_0 .var "load_token_emb", 0 0;
v000001fa49ca1740_0 .var "load_token_idx", 3 0;
v000001fa49ca1c40_0 .net "logits_out", 63 0, v000001fa49c9efb0_0;  1 drivers
v000001fa49ca1100_0 .var "position_in", 2 0;
v000001fa49ca1380_0 .var "rst", 0 0;
v000001fa49ca17e0_0 .var/i "timeout_cnt", 31 0;
v000001fa49ca1880_0 .var/i "tok", 31 0;
v000001fa49ca1e20_0 .var "token_in", 3 0;
v000001fa49ca1f60_0 .net "token_out", 3 0, v000001fa49c9fa50_0;  1 drivers
v000001fa49ca20a0_0 .var/real "val_real", 0 0;
v000001fa49ca0200_0 .var "valid_in", 0 0;
v000001fa49ca0980_0 .net "valid_out", 0 0, v000001fa49c9fd70_0;  1 drivers
v000001fa49ca1240_0 .var "wk_flat", 255 0;
v000001fa49ca07a0_0 .var "wo_flat", 255 0;
v000001fa49ca12e0_0 .var "wq_flat", 255 0;
v000001fa49ca16a0_0 .var "wv_flat", 255 0;
S_000001fa49b3baf0 .scope task, "load_pos" "load_pos" 3 135, 3 135 0, S_000001fa49c1b900;
 .timescale -9 -12;
v000001fa49c8b680_0 .var "didx", 1 0;
v000001fa49c8c580_0 .var "pidx", 2 0;
v000001fa49c8cb20_0 .var/s "val", 15 0;
E_000001fa49c2ce80 .event negedge, v000001fa49c8ce40_0;
TD_gpt2_demo_tb.load_pos ;
    %wait E_000001fa49c2ce80;
    %pushi/vec4 1, 0, 1;
    %store/vec4 v000001fa49ca1060_0, 0, 1;
    %load/vec4 v000001fa49c8c580_0;
    %store/vec4 v000001fa49ca2000_0, 0, 3;
    %load/vec4 v000001fa49c8b680_0;
    %store/vec4 v000001fa49ca11a0_0, 0, 2;
    %load/vec4 v000001fa49c8cb20_0;
    %store/vec4 v000001fa49ca1ec0_0, 0, 16;
    %wait E_000001fa49c2ce80;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v000001fa49ca1060_0, 0, 1;
    %end;
S_000001fa49ad7f80 .scope task, "load_tok" "load_tok" 3 123, 3 123 0, S_000001fa49c1b900;
 .timescale -9 -12;
v000001fa49c8c6c0_0 .var "didx", 1 0;
v000001fa49c8c9e0_0 .var "tidx", 3 0;
v000001fa49c8cee0_0 .var/s "val", 15 0;
TD_gpt2_demo_tb.load_tok ;
    %wait E_000001fa49c2ce80;
    %pushi/vec4 1, 0, 1;
    %store/vec4 v000001fa49ca1d80_0, 0, 1;
    %load/vec4 v000001fa49c8c9e0_0;
    %store/vec4 v000001fa49ca1740_0, 0, 4;
    %load/vec4 v000001fa49c8c6c0_0;
    %store/vec4 v000001fa49ca11a0_0, 0, 2;
    %load/vec4 v000001fa49c8cee0_0;
    %store/vec4 v000001fa49ca1ec0_0, 0, 16;
    %wait E_000001fa49c2ce80;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v000001fa49ca1d80_0, 0, 1;
    %end;
S_000001fa49ad8110 .scope function.vec4.s512, "make_ffn_w1" "make_ffn_w1" 3 77, 3 77 0, S_000001fa49c1b900;
 .timescale -9 -12;
v000001fa49c8c620_0 .var/i "c", 31 0;
v000001fa49c8cbc0_0 .var "dummy", 0 0;
; Variable make_ffn_w1 is vec4 return value of scope S_000001fa49ad8110
v000001fa49c8c260_0 .var "mat", 511 0;
v000001fa49c8cda0_0 .var/i "r", 31 0;
TD_gpt2_demo_tb.make_ffn_w1 ;
    %pushi/vec4 0, 0, 512;
    %store/vec4 v000001fa49c8c260_0, 0, 512;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8cda0_0, 0, 32;
T_2.0 ;
    %load/vec4 v000001fa49c8cda0_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_2.1, 5;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8c620_0, 0, 32;
T_2.2 ;
    %load/vec4 v000001fa49c8c620_0;
    %cmpi/s 8, 0, 32;
    %jmp/0xz T_2.3, 5;
    %load/vec4 v000001fa49c8cda0_0;
    %load/vec4 v000001fa49c8c620_0;
    %cmp/e;
    %flag_mov 8, 4;
    %jmp/0 T_2.4, 8;
    %pushi/vec4 256, 0, 16;
    %jmp/1 T_2.5, 8;
T_2.4 ; End of true expr.
    %pushi/vec4 0, 0, 16;
    %jmp/0 T_2.5, 8;
 ; End of false expr.
    %blend;
T_2.5;
    %load/vec4 v000001fa49c8cda0_0;
    %muli 8, 0, 32;
    %load/vec4 v000001fa49c8c620_0;
    %add;
    %muli 16, 0, 32;
    %ix/vec4/s 4;
    %store/vec4 v000001fa49c8c260_0, 4, 16;
    %load/vec4 v000001fa49c8c620_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8c620_0, 0, 32;
    %jmp T_2.2;
T_2.3 ;
    %load/vec4 v000001fa49c8cda0_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8cda0_0, 0, 32;
    %jmp T_2.0;
T_2.1 ;
    %load/vec4 v000001fa49c8c260_0;
    %ret/vec4 0, 0, 512;  Assign to make_ffn_w1 (store_vec4_to_lval)
    %end;
S_000001fa49b78090 .scope function.vec4.s512, "make_ffn_w2" "make_ffn_w2" 3 90, 3 90 0, S_000001fa49c1b900;
 .timescale -9 -12;
v000001fa49c8bf40_0 .var/i "c", 31 0;
v000001fa49c8b400_0 .var "dummy", 0 0;
; Variable make_ffn_w2 is vec4 return value of scope S_000001fa49b78090
v000001fa49c8c3a0_0 .var "mat", 511 0;
v000001fa49c8cf80_0 .var/i "r", 31 0;
TD_gpt2_demo_tb.make_ffn_w2 ;
    %pushi/vec4 0, 0, 512;
    %store/vec4 v000001fa49c8c3a0_0, 0, 512;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8cf80_0, 0, 32;
T_3.6 ;
    %load/vec4 v000001fa49c8cf80_0;
    %cmpi/s 8, 0, 32;
    %jmp/0xz T_3.7, 5;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8bf40_0, 0, 32;
T_3.8 ;
    %load/vec4 v000001fa49c8bf40_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_3.9, 5;
    %load/vec4 v000001fa49c8cf80_0;
    %load/vec4 v000001fa49c8bf40_0;
    %cmp/e;
    %flag_mov 8, 4;
    %jmp/0 T_3.10, 8;
    %pushi/vec4 256, 0, 16;
    %jmp/1 T_3.11, 8;
T_3.10 ; End of true expr.
    %pushi/vec4 0, 0, 16;
    %jmp/0 T_3.11, 8;
 ; End of false expr.
    %blend;
T_3.11;
    %load/vec4 v000001fa49c8cf80_0;
    %muli 4, 0, 32;
    %load/vec4 v000001fa49c8bf40_0;
    %add;
    %muli 16, 0, 32;
    %ix/vec4/s 4;
    %store/vec4 v000001fa49c8c3a0_0, 4, 16;
    %load/vec4 v000001fa49c8bf40_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8bf40_0, 0, 32;
    %jmp T_3.8;
T_3.9 ;
    %load/vec4 v000001fa49c8cf80_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8cf80_0, 0, 32;
    %jmp T_3.6;
T_3.7 ;
    %load/vec4 v000001fa49c8c3a0_0;
    %ret/vec4 0, 0, 512;  Assign to make_ffn_w2 (store_vec4_to_lval)
    %end;
S_000001fa49b78220 .scope function.vec4.s256, "make_identity" "make_identity" 3 64, 3 64 0, S_000001fa49c1b900;
 .timescale -9 -12;
v000001fa49c8c440_0 .var/i "c", 31 0;
v000001fa49c8b9a0_0 .var "dummy", 0 0;
; Variable make_identity is vec4 return value of scope S_000001fa49b78220
v000001fa49c8ba40_0 .var "mat", 255 0;
v000001fa49c8b180_0 .var/i "r", 31 0;
TD_gpt2_demo_tb.make_identity ;
    %pushi/vec4 0, 0, 256;
    %store/vec4 v000001fa49c8ba40_0, 0, 256;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8b180_0, 0, 32;
T_4.12 ;
    %load/vec4 v000001fa49c8b180_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_4.13, 5;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8c440_0, 0, 32;
T_4.14 ;
    %load/vec4 v000001fa49c8c440_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_4.15, 5;
    %load/vec4 v000001fa49c8b180_0;
    %load/vec4 v000001fa49c8c440_0;
    %cmp/e;
    %flag_mov 8, 4;
    %jmp/0 T_4.16, 8;
    %pushi/vec4 256, 0, 16;
    %jmp/1 T_4.17, 8;
T_4.16 ; End of true expr.
    %pushi/vec4 0, 0, 16;
    %jmp/0 T_4.17, 8;
 ; End of false expr.
    %blend;
T_4.17;
    %load/vec4 v000001fa49c8b180_0;
    %muli 4, 0, 32;
    %load/vec4 v000001fa49c8c440_0;
    %add;
    %muli 16, 0, 32;
    %ix/vec4/s 4;
    %store/vec4 v000001fa49c8ba40_0, 4, 16;
    %load/vec4 v000001fa49c8c440_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8c440_0, 0, 32;
    %jmp T_4.14;
T_4.15 ;
    %load/vec4 v000001fa49c8b180_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8b180_0, 0, 32;
    %jmp T_4.12;
T_4.13 ;
    %load/vec4 v000001fa49c8ba40_0;
    %ret/vec4 0, 0, 256;  Assign to make_identity (store_vec4_to_lval)
    %end;
S_000001fa49b25860 .scope task, "print_header" "print_header" 3 104, 3 104 0, S_000001fa49c1b900;
 .timescale -9 -12;
TD_gpt2_demo_tb.print_header ;
    %vpi_call 3 106 "$display", "\000" {0 0 0};
    %vpi_call 3 107 "$display", "================================================================" {0 0 0};
    %vpi_call 3 108 "$display", "   ____  _ _   _           ____  _ _      ____ ____  _   _" {0 0 0};
    %vpi_call 3 109 "$display", "  | __ )(_) |_| |__  _   _| __ )(_) |_   / ___|  _ \134| | | |" {0 0 0};
    %vpi_call 3 110 "$display", "  |  _ \134| | __| '_ \134| | | |  _ \134| | __| | |  _| |_) | | | |" {0 0 0};
    %vpi_call 3 111 "$display", "  | |_) | | |_| |_) | |_| | |_) | | |_  | |_| |  __/| |_| |" {0 0 0};
    %vpi_call 3 112 "$display", "  |____/|_|\134__|_.__/ \134__, |____/|_|\134__|  \134____|_|    \134___/" {0 0 0};
    %vpi_call 3 113 "$display", "                     |___/" {0 0 0};
    %vpi_call 3 114 "$display", "================================================================" {0 0 0};
    %vpi_call 3 115 "$display", "  Custom GPU Architecture for GPT-2 Inference" {0 0 0};
    %vpi_call 3 116 "$display", "  Q8.8 Fixed-Point | Zero-Skip Optimization" {0 0 0};
    %vpi_call 3 117 "$display", "  %0d Transformer Layers | %0d-dim Embeddings", P_000001fa49c130d0, P_000001fa49c12fb8 {0 0 0};
    %vpi_call 3 118 "$display", "================================================================" {0 0 0};
    %vpi_call 3 119 "$display", "\000" {0 0 0};
    %end;
S_000001fa49b259f0 .scope task, "run_inference" "run_inference" 3 147, 3 147 0, S_000001fa49c1b900;
 .timescale -9 -12;
v000001fa49c8b860_0 .var "in_pos", 2 0;
v000001fa49c8c760_0 .var "in_token", 3 0;
TD_gpt2_demo_tb.run_inference ;
    %vpi_call 3 151 "$display", "----------------------------------------------------------------" {0 0 0};
    %vpi_call 3 152 "$display", "  INPUT TOKEN: %0d  |  POSITION: %0d", v000001fa49c8c760_0, v000001fa49c8b860_0 {0 0 0};
    %vpi_call 3 153 "$display", "----------------------------------------------------------------" {0 0 0};
    %vpi_call 3 154 "$display", "\000" {0 0 0};
    %vpi_call 3 157 "$display", "  [STAGE 1] Embedding Lookup" {0 0 0};
    %vpi_call 3 158 "$display", "    Token ID %0d --> Token Embedding Table", v000001fa49c8c760_0 {0 0 0};
    %vpi_call 3 159 "$display", "    Position %0d --> Position Embedding Table", v000001fa49c8b860_0 {0 0 0};
    %vpi_call 3 160 "$display", "    Output: token_emb + pos_emb (Q8.8 vector)" {0 0 0};
    %vpi_call 3 161 "$display", "\000" {0 0 0};
    %wait E_000001fa49c2ce80;
    %load/vec4 v000001fa49c8c760_0;
    %store/vec4 v000001fa49ca1e20_0, 0, 4;
    %load/vec4 v000001fa49c8b860_0;
    %store/vec4 v000001fa49ca1100_0, 0, 3;
    %pushi/vec4 1, 0, 1;
    %store/vec4 v000001fa49ca0200_0, 0, 1;
    %wait E_000001fa49c2ce80;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v000001fa49ca0200_0, 0, 1;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49ca1880_0, 0, 32;
T_6.18 ;
    %load/vec4 v000001fa49ca1880_0;
    %cmpi/s 2, 0, 32;
    %jmp/0xz T_6.19, 5;
    %pushi/vec4 2, 0, 32;
    %load/vec4 v000001fa49ca1880_0;
    %add;
    %vpi_call 3 170 "$display", "  [STAGE %0d] Transformer Block %0d", S<0,vec4,s32>, v000001fa49ca1880_0 {1 0 0};
    %vpi_call 3 171 "$display", "    --> LayerNorm 1 (mean/var/normalize)" {0 0 0};
    %vpi_call 3 172 "$display", "    --> Multi-Head Self-Attention (Q*K^T*V)" {0 0 0};
    %vpi_call 3 173 "$display", "    --> Residual Add" {0 0 0};
    %vpi_call 3 174 "$display", "    --> LayerNorm 2" {0 0 0};
    %vpi_call 3 175 "$display", "    --> FFN: Linear(%0dx%0d) -> GELU -> Linear(%0dx%0d)", P_000001fa49c12fb8, P_000001fa49c12ff0, P_000001fa49c12ff0, P_000001fa49c12fb8 {0 0 0};
    %vpi_call 3 176 "$display", "    --> Residual Add" {0 0 0};
    %vpi_call 3 177 "$display", "\000" {0 0 0};
    %load/vec4 v000001fa49ca1880_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49ca1880_0, 0, 32;
    %jmp T_6.18;
T_6.19 ;
    %vpi_call 3 181 "$display", "  [STAGE %0d] Final LayerNorm + Argmax", 32'sb00000000000000000000000000000100 {0 0 0};
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49ca17e0_0, 0, 32;
T_6.20 ;
    %load/vec4 v000001fa49ca0980_0;
    %nor/r;
    %flag_set/vec4 9;
    %flag_get/vec4 9;
    %jmp/0 T_6.22, 9;
    %load/vec4 v000001fa49ca17e0_0;
    %cmpi/s 500, 0, 32;
    %flag_get/vec4 5;
    %and;
T_6.22;
    %flag_set/vec4 8;
    %jmp/0xz T_6.21, 8;
    %wait E_000001fa49c2ce80;
    %load/vec4 v000001fa49ca17e0_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49ca17e0_0, 0, 32;
    %jmp T_6.20;
T_6.21 ;
    %load/vec4 v000001fa49ca0980_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_6.23, 8;
    %vpi_call 3 191 "$display", "    Logits (Q8.8):" {0 0 0};
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c9eb50_0, 0, 32;
T_6.25 ;
    %load/vec4 v000001fa49c9eb50_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_6.26, 5;
    %load/vec4 v000001fa49ca1c40_0;
    %load/vec4 v000001fa49c9eb50_0;
    %muli 16, 0, 32;
    %part/s 16;
    %vpi_func/r 3 193 "$itor", S<0,vec4,s16> {1 0 0};
    %pushi/real 1073741824, 4074; load=256.000
    %div/wr;
    %store/real v000001fa49ca20a0_0;
    %vpi_call 3 194 "$display", "      logit[%0d] = %8.3f", v000001fa49c9eb50_0, v000001fa49ca20a0_0 {0 0 0};
    %load/vec4 v000001fa49c9eb50_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c9eb50_0, 0, 32;
    %jmp T_6.25;
T_6.26 ;
    %vpi_call 3 196 "$display", "\000" {0 0 0};
    %vpi_call 3 197 "$display", "  ================================================" {0 0 0};
    %vpi_call 3 198 "$display", "  | RESULT: Token %0d --> Predicted Token: %0d |", v000001fa49c8c760_0, v000001fa49ca1f60_0 {0 0 0};
    %vpi_call 3 199 "$display", "  | Latency: %0d clock cycles                  |", v000001fa49ca17e0_0 {0 0 0};
    %vpi_call 3 200 "$display", "  ================================================" {0 0 0};
    %jmp T_6.24;
T_6.23 ;
    %vpi_call 3 202 "$display", "  [ERROR] Inference timed out after %0d cycles!", v000001fa49ca17e0_0 {0 0 0};
T_6.24 ;
    %vpi_call 3 204 "$display", "\000" {0 0 0};
    %end;
S_000001fa49a66960 .scope module, "uut" "gpt2_engine" 3 42, 4 9 0, S_000001fa49c1b900;
 .timescale 0 0;
    .port_info 0 /INPUT 1 "clk";
    .port_info 1 /INPUT 1 "rst";
    .port_info 2 /INPUT 1 "load_token_emb";
    .port_info 3 /INPUT 4 "load_token_idx";
    .port_info 4 /INPUT 2 "load_dim_idx";
    .port_info 5 /INPUT 16 "load_emb_data";
    .port_info 6 /INPUT 1 "load_pos_emb";
    .port_info 7 /INPUT 3 "load_pos_idx";
    .port_info 8 /INPUT 64 "ln1_gamma";
    .port_info 9 /INPUT 64 "ln1_beta";
    .port_info 10 /INPUT 64 "ln2_gamma";
    .port_info 11 /INPUT 64 "ln2_beta";
    .port_info 12 /INPUT 256 "wq_flat";
    .port_info 13 /INPUT 256 "wk_flat";
    .port_info 14 /INPUT 256 "wv_flat";
    .port_info 15 /INPUT 256 "wo_flat";
    .port_info 16 /INPUT 512 "ffn_w1_flat";
    .port_info 17 /INPUT 128 "ffn_b1_flat";
    .port_info 18 /INPUT 512 "ffn_w2_flat";
    .port_info 19 /INPUT 64 "ffn_b2_flat";
    .port_info 20 /INPUT 64 "ln_final_gamma";
    .port_info 21 /INPUT 64 "ln_final_beta";
    .port_info 22 /INPUT 1 "valid_in";
    .port_info 23 /INPUT 4 "token_in";
    .port_info 24 /INPUT 3 "position_in";
    .port_info 25 /OUTPUT 4 "token_out";
    .port_info 26 /OUTPUT 64 "logits_out";
    .port_info 27 /OUTPUT 1 "valid_out";
P_000001fa49b0a480 .param/l "DATA_WIDTH" 0 4 17, +C4<00000000000000000000000000010000>;
P_000001fa49b0a4b8 .param/l "EMBEDDING" 1 4 68, C4<0001>;
P_000001fa49b0a4f0 .param/l "EMBED_DIM" 0 4 12, +C4<00000000000000000000000000000100>;
P_000001fa49b0a528 .param/l "FFN_DIM" 0 4 15, +C4<00000000000000000000000000001000>;
P_000001fa49b0a560 .param/l "FINAL_LN" 1 4 70, C4<0011>;
P_000001fa49b0a598 .param/l "HEAD_DIM" 0 4 14, +C4<00000000000000000000000000000010>;
P_000001fa49b0a5d0 .param/l "IDLE" 1 4 67, C4<0000>;
P_000001fa49b0a608 .param/l "LOGITS" 1 4 71, C4<0100>;
P_000001fa49b0a640 .param/l "MAX_SEQ_LEN" 0 4 11, +C4<00000000000000000000000000001000>;
P_000001fa49b0a678 .param/l "NUM_HEADS" 0 4 13, +C4<00000000000000000000000000000010>;
P_000001fa49b0a6b0 .param/l "NUM_LAYERS" 0 4 16, +C4<00000000000000000000000000000010>;
P_000001fa49b0a6e8 .param/l "OUTPUT" 1 4 72, C4<0101>;
P_000001fa49b0a720 .param/l "TRANSFORMER" 1 4 69, C4<0010>;
P_000001fa49b0a758 .param/l "VOCAB_SIZE" 0 4 10, +C4<00000000000000000000000000010000>;
L_000001fa49b6ddb0 .functor AND 1, v000001fa49ca0200_0, L_000001fa49ca27b0, C4<1>, C4<1>;
L_000001fa49ca41d8 .functor BUFT 1, C4<0000>, C4<0>, C4<0>, C4<0>;
v000001fa49c9f690_0 .net/2u *"_ivl_0", 3 0, L_000001fa49ca41d8;  1 drivers
v000001fa49c9f2d0_0 .net *"_ivl_2", 0 0, L_000001fa49ca27b0;  1 drivers
v000001fa49c9f370_0 .var "block_en", 0 0;
v000001fa49c9eab0_0 .net "block_out", 63 0, v000001fa49c9cbe0_0;  1 drivers
v000001fa49c9e5b0_0 .net "block_valid", 0 0, v000001fa49c9c460_0;  1 drivers
v000001fa49c9ed30_0 .net "clk", 0 0, v000001fa49c9fb90_0;  1 drivers
v000001fa49c9f0f0_0 .var "current_hidden", 63 0;
v000001fa49c9f410_0 .net "emb_out", 63 0, v000001fa49c9d7c0_0;  1 drivers
v000001fa49c9f4b0_0 .net "emb_valid", 0 0, v000001fa49c9c6e0_0;  1 drivers
v000001fa49c9f910_0 .net "ffn_b1_flat", 127 0, v000001fa49c9e510_0;  1 drivers
v000001fa49c9edd0_0 .net "ffn_b2_flat", 63 0, v000001fa49c9e8d0_0;  1 drivers
v000001fa49c9ee70_0 .net "ffn_w1_flat", 511 0, v000001fa49c9e970_0;  1 drivers
v000001fa49c9f550_0 .net "ffn_w2_flat", 511 0, v000001fa49c9ea10_0;  1 drivers
v000001fa49c9faf0_0 .var/i "i", 31 0;
v000001fa49c9f5f0_0 .var "layer_idx", 1 0;
v000001fa49c9fff0_0 .net "ln1_beta", 63 0, v000001fa49c9f190_0;  1 drivers
v000001fa49c9fc30_0 .net "ln1_gamma", 63 0, v000001fa49c9f230_0;  1 drivers
v000001fa49c9ff50_0 .net "ln2_beta", 63 0, v000001fa49ca19c0_0;  1 drivers
v000001fa49c9f9b0_0 .net "ln2_gamma", 63 0, v000001fa49ca1600_0;  1 drivers
v000001fa49c9ebf0_0 .net "ln_final_beta", 63 0, v000001fa49ca1ce0_0;  1 drivers
v000001fa49c9f730_0 .var "ln_final_en", 0 0;
v000001fa49c9f870_0 .net "ln_final_gamma", 63 0, v000001fa49ca1920_0;  1 drivers
v000001fa49ca0090_0 .net "ln_final_out", 63 0, v000001fa49c8d020_0;  1 drivers
v000001fa49c9e330_0 .net "ln_final_valid", 0 0, v000001fa49c9c320_0;  1 drivers
v000001fa49c9e6f0_0 .net "load_dim_idx", 1 0, v000001fa49ca11a0_0;  1 drivers
v000001fa49c9e1f0_0 .net/s "load_emb_data", 15 0, v000001fa49ca1ec0_0;  1 drivers
v000001fa49c9ef10_0 .net "load_pos_emb", 0 0, v000001fa49ca1060_0;  1 drivers
v000001fa49c9ec90_0 .net "load_pos_idx", 2 0, v000001fa49ca2000_0;  1 drivers
v000001fa49c9fe10_0 .net "load_token_emb", 0 0, v000001fa49ca1d80_0;  1 drivers
v000001fa49c9e290_0 .net "load_token_idx", 3 0, v000001fa49ca1740_0;  1 drivers
v000001fa49c9efb0_0 .var "logits_out", 63 0;
v000001fa49c9f7d0_0 .net "position_in", 2 0, v000001fa49ca1100_0;  1 drivers
v000001fa49c9e790_0 .net "rst", 0 0, v000001fa49ca1380_0;  1 drivers
v000001fa49c9f050_0 .var "state", 3 0;
v000001fa49c9e3d0_0 .net "token_in", 3 0, v000001fa49ca1e20_0;  1 drivers
v000001fa49c9fa50_0 .var "token_out", 3 0;
v000001fa49c9fcd0_0 .net "valid_in", 0 0, v000001fa49ca0200_0;  1 drivers
v000001fa49c9fd70_0 .var "valid_out", 0 0;
v000001fa49c9e470_0 .net "wk_flat", 255 0, v000001fa49ca1240_0;  1 drivers
v000001fa49c9e830_0 .net "wo_flat", 255 0, v000001fa49ca07a0_0;  1 drivers
v000001fa49c9e650_0 .net "wq_flat", 255 0, v000001fa49ca12e0_0;  1 drivers
v000001fa49c9feb0_0 .net "wv_flat", 255 0, v000001fa49ca16a0_0;  1 drivers
L_000001fa49ca27b0 .cmp/eq 4, v000001fa49c9f050_0, L_000001fa49ca41d8;
S_000001fa49c19890 .scope begin, "argmax_block" "argmax_block" 4 167, 4 167 0, S_000001fa49a66960;
 .timescale 0 0;
v000001fa49c8b2c0_0 .var "max_idx", 3 0;
v000001fa49c8c940_0 .var/s "max_val", 15 0;
S_000001fa49c19a20 .scope module, "u_block" "transformer_block" 4 94, 5 8 0, S_000001fa49a66960;
 .timescale 0 0;
    .port_info 0 /INPUT 1 "clk";
    .port_info 1 /INPUT 1 "rst";
    .port_info 2 /INPUT 1 "valid_in";
    .port_info 3 /INPUT 64 "x_in";
    .port_info 4 /INPUT 64 "ln1_gamma";
    .port_info 5 /INPUT 64 "ln1_beta";
    .port_info 6 /INPUT 64 "ln2_gamma";
    .port_info 7 /INPUT 64 "ln2_beta";
    .port_info 8 /INPUT 256 "wq_flat";
    .port_info 9 /INPUT 256 "wk_flat";
    .port_info 10 /INPUT 256 "wv_flat";
    .port_info 11 /INPUT 256 "wo_flat";
    .port_info 12 /INPUT 512 "ffn_w1_flat";
    .port_info 13 /INPUT 128 "ffn_b1_flat";
    .port_info 14 /INPUT 512 "ffn_w2_flat";
    .port_info 15 /INPUT 64 "ffn_b2_flat";
    .port_info 16 /OUTPUT 64 "y_out";
    .port_info 17 /OUTPUT 1 "valid_out";
P_000001fa49c19bb0 .param/l "ADD1" 1 5 46, C4<0011>;
P_000001fa49c19be8 .param/l "ADD2" 1 5 49, C4<0110>;
P_000001fa49c19c20 .param/l "ATTN" 1 5 45, C4<0010>;
P_000001fa49c19c58 .param/l "DATA_WIDTH" 0 5 13, +C4<00000000000000000000000000010000>;
P_000001fa49c19c90 .param/l "DONE" 1 5 50, C4<0111>;
P_000001fa49c19cc8 .param/l "EMBED_DIM" 0 5 9, +C4<00000000000000000000000000000100>;
P_000001fa49c19d00 .param/l "FFN" 1 5 48, C4<0101>;
P_000001fa49c19d38 .param/l "FFN_DIM" 0 5 12, +C4<00000000000000000000000000001000>;
P_000001fa49c19d70 .param/l "HEAD_DIM" 0 5 11, +C4<00000000000000000000000000000010>;
P_000001fa49c19da8 .param/l "IDLE" 1 5 43, C4<0000>;
P_000001fa49c19de0 .param/l "LN1" 1 5 44, C4<0001>;
P_000001fa49c19e18 .param/l "LN2" 1 5 47, C4<0100>;
P_000001fa49c19e50 .param/l "NUM_HEADS" 0 5 10, +C4<00000000000000000000000000000010>;
v000001fa49c9a270_0 .var "attn_en", 0 0;
v000001fa49c9a310_0 .net "attn_out", 63 0, v000001fa49c8c1c0_0;  1 drivers
v000001fa49c9b490_0 .net "attn_valid", 0 0, v000001fa49c8bb80_0;  1 drivers
v000001fa49c9ae50_0 .net "clk", 0 0, v000001fa49c9fb90_0;  alias, 1 drivers
v000001fa49c9a950_0 .net "ffn_b1_flat", 127 0, v000001fa49c9e510_0;  alias, 1 drivers
v000001fa49c9aef0_0 .net "ffn_b2_flat", 63 0, v000001fa49c9e8d0_0;  alias, 1 drivers
v000001fa49c9bcb0_0 .var "ffn_en", 0 0;
v000001fa49c9a3b0_0 .net "ffn_out", 63 0, v000001fa49c8f960_0;  1 drivers
v000001fa49c9b0d0_0 .net "ffn_valid", 0 0, v000001fa49c8f320_0;  1 drivers
v000001fa49c9bd50_0 .net "ffn_w1_flat", 511 0, v000001fa49c9e970_0;  alias, 1 drivers
v000001fa49c9bdf0_0 .net "ffn_w2_flat", 511 0, v000001fa49c9ea10_0;  alias, 1 drivers
v000001fa49c9af90_0 .var/i "i", 31 0;
v000001fa49c9a450_0 .net "ln1_beta", 63 0, v000001fa49c9f190_0;  alias, 1 drivers
v000001fa49c9a4f0_0 .var "ln1_en", 0 0;
v000001fa49c9a590_0 .net "ln1_gamma", 63 0, v000001fa49c9f230_0;  alias, 1 drivers
v000001fa49c9a6d0_0 .net "ln1_out", 63 0, v000001fa49c8ece0_0;  1 drivers
v000001fa49c9a810_0 .net "ln1_valid", 0 0, v000001fa49c8e740_0;  1 drivers
v000001fa49c9aa90_0 .net "ln2_beta", 63 0, v000001fa49ca19c0_0;  alias, 1 drivers
v000001fa49c9ab30_0 .var "ln2_en", 0 0;
v000001fa49c9b030_0 .net "ln2_gamma", 63 0, v000001fa49ca1600_0;  alias, 1 drivers
v000001fa49c9b170_0 .net "ln2_out", 63 0, v000001fa49c9adb0_0;  1 drivers
v000001fa49c9b2b0_0 .net "ln2_valid", 0 0, v000001fa49c9a8b0_0;  1 drivers
v000001fa49c9b350_0 .var "residual1", 63 0;
v000001fa49c9b3f0_0 .var "residual2", 63 0;
v000001fa49c9b5d0_0 .net "rst", 0 0, v000001fa49ca1380_0;  alias, 1 drivers
v000001fa49c9d2c0_0 .var "state", 3 0;
v000001fa49c9c960_0 .net "valid_in", 0 0, v000001fa49c9f370_0;  1 drivers
v000001fa49c9c460_0 .var "valid_out", 0 0;
v000001fa49c9d360_0 .net "wk_flat", 255 0, v000001fa49ca1240_0;  alias, 1 drivers
v000001fa49c9c5a0_0 .net "wo_flat", 255 0, v000001fa49ca07a0_0;  alias, 1 drivers
v000001fa49c9d680_0 .net "wq_flat", 255 0, v000001fa49ca12e0_0;  alias, 1 drivers
v000001fa49c9cd20_0 .net "wv_flat", 255 0, v000001fa49ca16a0_0;  alias, 1 drivers
v000001fa49c9d720_0 .net "x_in", 63 0, v000001fa49c9f0f0_0;  1 drivers
v000001fa49c9cbe0_0 .var "y_out", 63 0;
S_000001fa49c1c370 .scope module, "u_attn" "attention_unit" 5 63, 6 9 0, S_000001fa49c19a20;
 .timescale 0 0;
    .port_info 0 /INPUT 1 "clk";
    .port_info 1 /INPUT 1 "rst";
    .port_info 2 /INPUT 1 "valid_in";
    .port_info 3 /INPUT 64 "x_in";
    .port_info 4 /INPUT 256 "wq_flat";
    .port_info 5 /INPUT 256 "wk_flat";
    .port_info 6 /INPUT 256 "wv_flat";
    .port_info 7 /INPUT 256 "wo_flat";
    .port_info 8 /OUTPUT 64 "y_out";
    .port_info 9 /OUTPUT 1 "valid_out";
P_000001fa49c1c500 .param/l "ATTENTION" 1 6 51, C4<0011>;
P_000001fa49c1c538 .param/l "DATA_WIDTH" 0 6 13, +C4<00000000000000000000000000010000>;
P_000001fa49c1c570 .param/l "DONE" 1 6 53, C4<0101>;
P_000001fa49c1c5a8 .param/l "EMBED_DIM" 0 6 10, +C4<00000000000000000000000000000100>;
P_000001fa49c1c5e0 .param/l "HEAD_DIM" 0 6 12, +C4<00000000000000000000000000000010>;
P_000001fa49c1c618 .param/l "IDLE" 1 6 48, C4<0000>;
P_000001fa49c1c650 .param/l "LOAD_W" 1 6 49, C4<0001>;
P_000001fa49c1c688 .param/l "NUM_HEADS" 0 6 11, +C4<00000000000000000000000000000010>;
P_000001fa49c1c6c0 .param/l "OUT_PROJ" 1 6 52, C4<0100>;
P_000001fa49c1c6f8 .param/l "PROJ_QKV" 1 6 50, C4<0010>;
v000001fa49c8cc60_0 .var/s "accum", 31 0;
v000001fa49c8b220 .array/s "attn_out", 3 0, 15 0;
v000001fa49c8ce40_0 .net "clk", 0 0, v000001fa49c9fb90_0;  alias, 1 drivers
v000001fa49c8b360_0 .var/i "i", 31 0;
v000001fa49c8cd00_0 .var/i "j", 31 0;
v000001fa49c8b900 .array/s "k", 3 0, 15 0;
v000001fa49c8b4a0_0 .var/s "product", 31 0;
v000001fa49c8c800 .array/s "q", 3 0, 15 0;
v000001fa49c8b540_0 .net "rst", 0 0, v000001fa49ca1380_0;  alias, 1 drivers
v000001fa49c8b5e0_0 .var "state", 3 0;
v000001fa49c8b7c0 .array/s "v", 3 0, 15 0;
v000001fa49c8bae0_0 .net "valid_in", 0 0, v000001fa49c9a270_0;  1 drivers
v000001fa49c8bb80_0 .var "valid_out", 0 0;
v000001fa49c8bc20 .array/s "wk", 15 0, 15 0;
v000001fa49c8c8a0_0 .net "wk_flat", 255 0, v000001fa49ca1240_0;  alias, 1 drivers
v000001fa49c8bcc0 .array/s "wo", 15 0, 15 0;
v000001fa49c8bd60_0 .net "wo_flat", 255 0, v000001fa49ca07a0_0;  alias, 1 drivers
v000001fa49c8be00 .array/s "wq", 15 0, 15 0;
v000001fa49c8bfe0_0 .net "wq_flat", 255 0, v000001fa49ca12e0_0;  alias, 1 drivers
v000001fa49c8bea0 .array/s "wv", 15 0, 15 0;
v000001fa49c8c080_0 .net "wv_flat", 255 0, v000001fa49ca16a0_0;  alias, 1 drivers
v000001fa49c8c300 .array/s "x", 3 0, 15 0;
v000001fa49c8c120_0 .net "x_in", 63 0, v000001fa49c8ece0_0;  alias, 1 drivers
v000001fa49c8c1c0_0 .var "y_out", 63 0;
E_000001fa49c2d000 .event posedge, v000001fa49c8ce40_0;
S_000001fa49c8d640 .scope module, "u_ffn" "ffn_block" 5 78, 7 9 0, S_000001fa49c19a20;
 .timescale 0 0;
    .port_info 0 /INPUT 1 "clk";
    .port_info 1 /INPUT 1 "rst";
    .port_info 2 /INPUT 1 "valid_in";
    .port_info 3 /INPUT 64 "x_in";
    .port_info 4 /INPUT 512 "w1_flat";
    .port_info 5 /INPUT 128 "b1_flat";
    .port_info 6 /INPUT 512 "w2_flat";
    .port_info 7 /INPUT 64 "b2_flat";
    .port_info 8 /OUTPUT 64 "y_out";
    .port_info 9 /OUTPUT 1 "valid_out";
P_000001fa49c1c740 .param/l "DATA_WIDTH" 0 7 12, +C4<00000000000000000000000000010000>;
P_000001fa49c1c778 .param/l "DONE" 1 7 57, C4<0100>;
P_000001fa49c1c7b0 .param/l "EMBED_DIM" 0 7 10, +C4<00000000000000000000000000000100>;
P_000001fa49c1c7e8 .param/l "FFN_DIM" 0 7 11, +C4<00000000000000000000000000001000>;
P_000001fa49c1c820 .param/l "GELU" 1 7 55, C4<0010>;
P_000001fa49c1c858 .param/l "HALF" 1 7 44, +C4<0000000010000000>;
P_000001fa49c1c890 .param/l "IDLE" 1 7 53, C4<0000>;
P_000001fa49c1c8c8 .param/l "LINEAR1" 1 7 54, C4<0001>;
P_000001fa49c1c900 .param/l "LINEAR2" 1 7 56, C4<0011>;
P_000001fa49c1c938 .param/l "NEG_THREE" 1 7 42, +C4<1111110100000000>;
P_000001fa49c1c970 .param/l "POS_THREE" 1 7 43, +C4<0000001100000000>;
P_000001fa49c1c9a8 .param/l "SLOPE" 1 7 45, +C4<0000000000101011>;
v000001fa49c8f1e0_0 .var/s "accum", 31 0;
v000001fa49c8f280 .array/s "activated", 7 0, 15 0;
v000001fa49c8ea60 .array/s "b1", 7 0, 15 0;
v000001fa49c8fa00_0 .net "b1_flat", 127 0, v000001fa49c9e510_0;  alias, 1 drivers
v000001fa49c8f3c0 .array/s "b2", 3 0, 15 0;
v000001fa49c8faa0_0 .net "b2_flat", 63 0, v000001fa49c9e8d0_0;  alias, 1 drivers
v000001fa49c8eb00_0 .net "clk", 0 0, v000001fa49c9fb90_0;  alias, 1 drivers
v000001fa49c8ec40_0 .var/s "gelu_prod", 31 0;
v000001fa49c8f6e0 .array/s "hidden", 7 0, 15 0;
v000001fa49c8f780_0 .var/i "i", 31 0;
v000001fa49c8f000_0 .var/i "j", 31 0;
v000001fa49c8fb40_0 .var/s "product", 31 0;
v000001fa49c8ee20_0 .net "rst", 0 0, v000001fa49ca1380_0;  alias, 1 drivers
v000001fa49c8fc80_0 .var/s "sig_approx", 15 0;
v000001fa49c8ffa0_0 .var/s "slope_x", 31 0;
v000001fa49c8eec0_0 .var "state", 3 0;
v000001fa49c90040_0 .net "valid_in", 0 0, v000001fa49c9bcb0_0;  1 drivers
v000001fa49c8f320_0 .var "valid_out", 0 0;
v000001fa49c8e1a0 .array/s "w1", 31 0, 15 0;
v000001fa49c8e240_0 .net "w1_flat", 511 0, v000001fa49c9e970_0;  alias, 1 drivers
v000001fa49c8f820 .array/s "w2", 31 0, 15 0;
v000001fa49c8e2e0_0 .net "w2_flat", 511 0, v000001fa49c9ea10_0;  alias, 1 drivers
v000001fa49c8fdc0 .array/s "x", 3 0, 15 0;
v000001fa49c8f8c0_0 .net "x_in", 63 0, v000001fa49c9adb0_0;  alias, 1 drivers
v000001fa49c8f960_0 .var "y_out", 63 0;
S_000001fa49c8d190 .scope module, "u_ln1" "layer_norm" 5 55, 8 9 0, S_000001fa49c19a20;
 .timescale 0 0;
    .port_info 0 /INPUT 1 "clk";
    .port_info 1 /INPUT 1 "rst";
    .port_info 2 /INPUT 1 "valid_in";
    .port_info 3 /INPUT 64 "x_in";
    .port_info 4 /INPUT 64 "gamma_in";
    .port_info 5 /INPUT 64 "beta_in";
    .port_info 6 /OUTPUT 64 "y_out";
    .port_info 7 /OUTPUT 1 "valid_out";
P_000001fa49c1d190 .param/l "CALC_INVSTD" 1 8 42, C4<0011>;
P_000001fa49c1d1c8 .param/l "CALC_MEAN" 1 8 40, C4<0001>;
P_000001fa49c1d200 .param/l "CALC_VAR" 1 8 41, C4<0010>;
P_000001fa49c1d238 .param/l "DATA_WIDTH" 0 8 11, +C4<00000000000000000000000000010000>;
P_000001fa49c1d270 .param/l "DIM" 0 8 10, +C4<00000000000000000000000000000100>;
P_000001fa49c1d2a8 .param/l "IDLE" 1 8 39, C4<0000>;
P_000001fa49c1d2e0 .param/l "NORMALIZE" 1 8 43, C4<0100>;
P_000001fa49c1d318 .param/l "OUTPUT" 1 8 44, C4<0101>;
v000001fa49c8e380 .array/s "beta", 3 0, 15 0;
v000001fa49c8e420_0 .net "beta_in", 63 0, v000001fa49c9f190_0;  alias, 1 drivers
v000001fa49c8f5a0_0 .net "clk", 0 0, v000001fa49c9fb90_0;  alias, 1 drivers
v000001fa49c8ed80_0 .var/s "diff", 15 0;
v000001fa49c8e880 .array/s "gamma", 3 0, 15 0;
v000001fa49c8f0a0_0 .net "gamma_in", 63 0, v000001fa49c9f230_0;  alias, 1 drivers
v000001fa49c8fd20_0 .var/i "i", 31 0;
v000001fa49c8fe60_0 .var "idx", 2 0;
v000001fa49c8f140_0 .var/s "inv_std", 15 0;
v000001fa49c8f500_0 .var/s "mean_val", 15 0;
v000001fa49c8f640_0 .var/s "norm_val", 31 0;
v000001fa49c8ff00_0 .net "rst", 0 0, v000001fa49ca1380_0;  alias, 1 drivers
v000001fa49c8e4c0_0 .var/s "scaled", 31 0;
v000001fa49c8e560_0 .var "state", 3 0;
v000001fa49c8e600_0 .var/s "sum_acc", 23 0;
v000001fa49c8e6a0_0 .net "valid_in", 0 0, v000001fa49c9a4f0_0;  1 drivers
v000001fa49c8e740_0 .var "valid_out", 0 0;
v000001fa49c8e7e0_0 .var/s "var_acc", 31 0;
v000001fa49c8e920_0 .var/s "var_val", 15 0;
v000001fa49c8e9c0 .array/s "x_buf", 3 0, 15 0;
v000001fa49c8eba0_0 .net "x_in", 63 0, v000001fa49c9b350_0;  1 drivers
v000001fa49c8ece0_0 .var "y_out", 63 0;
S_000001fa49c8de10 .scope function.vec4.u16, "approx_inv_sqrt" "approx_inv_sqrt" 8 51, 8 51 0, S_000001fa49c8d190;
 .timescale 0 0;
v000001fa49c8ef60_0 .var "abs_val", 15 0;
; Variable approx_inv_sqrt is vec4 return value of scope S_000001fa49c8de10
v000001fa49c8f460_0 .var/s "val", 15 0;
TD_gpt2_demo_tb.uut.u_block.u_ln1.approx_inv_sqrt ;
    %load/vec4 v000001fa49c8f460_0;
    %pad/s 32;
    %cmpi/s 0, 0, 32;
    %flag_mov 8, 5;
    %jmp/0 T_7.27, 8;
    %load/vec4 v000001fa49c8f460_0;
    %inv;
    %pushi/vec4 1, 0, 16;
    %add;
    %jmp/1 T_7.28, 8;
T_7.27 ; End of true expr.
    %load/vec4 v000001fa49c8f460_0;
    %jmp/0 T_7.28, 8;
 ; End of false expr.
    %blend;
T_7.28;
    %store/vec4 v000001fa49c8ef60_0, 0, 16;
    %load/vec4 v000001fa49c8ef60_0;
    %pad/u 32;
    %cmpi/e 0, 0, 32;
    %jmp/0xz  T_7.29, 4;
    %pushi/vec4 256, 0, 16;
    %ret/vec4 0, 0, 16;  Assign to approx_inv_sqrt (store_vec4_to_lval)
    %jmp T_7.30;
T_7.29 ;
    %load/vec4 v000001fa49c8ef60_0;
    %cmpi/u 64, 0, 16;
    %flag_or 5, 4;
    %jmp/0xz  T_7.31, 5;
    %pushi/vec4 512, 0, 16;
    %ret/vec4 0, 0, 16;  Assign to approx_inv_sqrt (store_vec4_to_lval)
    %jmp T_7.32;
T_7.31 ;
    %load/vec4 v000001fa49c8ef60_0;
    %cmpi/u 256, 0, 16;
    %flag_or 5, 4;
    %jmp/0xz  T_7.33, 5;
    %pushi/vec4 256, 0, 16;
    %ret/vec4 0, 0, 16;  Assign to approx_inv_sqrt (store_vec4_to_lval)
    %jmp T_7.34;
T_7.33 ;
    %load/vec4 v000001fa49c8ef60_0;
    %cmpi/u 1024, 0, 16;
    %flag_or 5, 4;
    %jmp/0xz  T_7.35, 5;
    %pushi/vec4 128, 0, 16;
    %ret/vec4 0, 0, 16;  Assign to approx_inv_sqrt (store_vec4_to_lval)
    %jmp T_7.36;
T_7.35 ;
    %pushi/vec4 64, 0, 16;
    %ret/vec4 0, 0, 16;  Assign to approx_inv_sqrt (store_vec4_to_lval)
T_7.36 ;
T_7.34 ;
T_7.32 ;
T_7.30 ;
    %end;
S_000001fa49c8d7d0 .scope module, "u_ln2" "layer_norm" 5 71, 8 9 0, S_000001fa49c19a20;
 .timescale 0 0;
    .port_info 0 /INPUT 1 "clk";
    .port_info 1 /INPUT 1 "rst";
    .port_info 2 /INPUT 1 "valid_in";
    .port_info 3 /INPUT 64 "x_in";
    .port_info 4 /INPUT 64 "gamma_in";
    .port_info 5 /INPUT 64 "beta_in";
    .port_info 6 /OUTPUT 64 "y_out";
    .port_info 7 /OUTPUT 1 "valid_out";
P_000001fa49c1d360 .param/l "CALC_INVSTD" 1 8 42, C4<0011>;
P_000001fa49c1d398 .param/l "CALC_MEAN" 1 8 40, C4<0001>;
P_000001fa49c1d3d0 .param/l "CALC_VAR" 1 8 41, C4<0010>;
P_000001fa49c1d408 .param/l "DATA_WIDTH" 0 8 11, +C4<00000000000000000000000000010000>;
P_000001fa49c1d440 .param/l "DIM" 0 8 10, +C4<00000000000000000000000000000100>;
P_000001fa49c1d478 .param/l "IDLE" 1 8 39, C4<0000>;
P_000001fa49c1d4b0 .param/l "NORMALIZE" 1 8 43, C4<0100>;
P_000001fa49c1d4e8 .param/l "OUTPUT" 1 8 44, C4<0101>;
v000001fa49c9c070 .array/s "beta", 3 0, 15 0;
v000001fa49c9b7b0_0 .net "beta_in", 63 0, v000001fa49ca19c0_0;  alias, 1 drivers
v000001fa49c9bc10_0 .net "clk", 0 0, v000001fa49c9fb90_0;  alias, 1 drivers
v000001fa49c9b710_0 .var/s "diff", 15 0;
v000001fa49c9b670 .array/s "gamma", 3 0, 15 0;
v000001fa49c9b530_0 .net "gamma_in", 63 0, v000001fa49ca1600_0;  alias, 1 drivers
v000001fa49c9ac70_0 .var/i "i", 31 0;
v000001fa49c9a1d0_0 .var "idx", 2 0;
v000001fa49c9a770_0 .var/s "inv_std", 15 0;
v000001fa49c9ad10_0 .var/s "mean_val", 15 0;
v000001fa49c9ba30_0 .var/s "norm_val", 31 0;
v000001fa49c9be90_0 .net "rst", 0 0, v000001fa49ca1380_0;  alias, 1 drivers
v000001fa49c9abd0_0 .var/s "scaled", 31 0;
v000001fa49c9b990_0 .var "state", 3 0;
v000001fa49c9a630_0 .var/s "sum_acc", 23 0;
v000001fa49c9a9f0_0 .net "valid_in", 0 0, v000001fa49c9ab30_0;  1 drivers
v000001fa49c9a8b0_0 .var "valid_out", 0 0;
v000001fa49c9b210_0 .var/s "var_acc", 31 0;
v000001fa49c9bad0_0 .var/s "var_val", 15 0;
v000001fa49c9bf30 .array/s "x_buf", 3 0, 15 0;
v000001fa49c9bb70_0 .net "x_in", 63 0, v000001fa49c9b3f0_0;  1 drivers
v000001fa49c9adb0_0 .var "y_out", 63 0;
S_000001fa49c8d960 .scope function.vec4.u16, "approx_inv_sqrt" "approx_inv_sqrt" 8 51, 8 51 0, S_000001fa49c8d7d0;
 .timescale 0 0;
v000001fa49c9b8f0_0 .var "abs_val", 15 0;
; Variable approx_inv_sqrt is vec4 return value of scope S_000001fa49c8d960
v000001fa49c9b850_0 .var/s "val", 15 0;
TD_gpt2_demo_tb.uut.u_block.u_ln2.approx_inv_sqrt ;
    %load/vec4 v000001fa49c9b850_0;
    %pad/s 32;
    %cmpi/s 0, 0, 32;
    %flag_mov 8, 5;
    %jmp/0 T_8.37, 8;
    %load/vec4 v000001fa49c9b850_0;
    %inv;
    %pushi/vec4 1, 0, 16;
    %add;
    %jmp/1 T_8.38, 8;
T_8.37 ; End of true expr.
    %load/vec4 v000001fa49c9b850_0;
    %jmp/0 T_8.38, 8;
 ; End of false expr.
    %blend;
T_8.38;
    %store/vec4 v000001fa49c9b8f0_0, 0, 16;
    %load/vec4 v000001fa49c9b8f0_0;
    %pad/u 32;
    %cmpi/e 0, 0, 32;
    %jmp/0xz  T_8.39, 4;
    %pushi/vec4 256, 0, 16;
    %ret/vec4 0, 0, 16;  Assign to approx_inv_sqrt (store_vec4_to_lval)
    %jmp T_8.40;
T_8.39 ;
    %load/vec4 v000001fa49c9b8f0_0;
    %cmpi/u 64, 0, 16;
    %flag_or 5, 4;
    %jmp/0xz  T_8.41, 5;
    %pushi/vec4 512, 0, 16;
    %ret/vec4 0, 0, 16;  Assign to approx_inv_sqrt (store_vec4_to_lval)
    %jmp T_8.42;
T_8.41 ;
    %load/vec4 v000001fa49c9b8f0_0;
    %cmpi/u 256, 0, 16;
    %flag_or 5, 4;
    %jmp/0xz  T_8.43, 5;
    %pushi/vec4 256, 0, 16;
    %ret/vec4 0, 0, 16;  Assign to approx_inv_sqrt (store_vec4_to_lval)
    %jmp T_8.44;
T_8.43 ;
    %load/vec4 v000001fa49c9b8f0_0;
    %cmpi/u 1024, 0, 16;
    %flag_or 5, 4;
    %jmp/0xz  T_8.45, 5;
    %pushi/vec4 128, 0, 16;
    %ret/vec4 0, 0, 16;  Assign to approx_inv_sqrt (store_vec4_to_lval)
    %jmp T_8.46;
T_8.45 ;
    %pushi/vec4 64, 0, 16;
    %ret/vec4 0, 0, 16;  Assign to approx_inv_sqrt (store_vec4_to_lval)
T_8.46 ;
T_8.44 ;
T_8.42 ;
T_8.40 ;
    %end;
S_000001fa49c8daf0 .scope module, "u_emb" "embedding_lookup" 4 80, 9 8 0, S_000001fa49a66960;
 .timescale 0 0;
    .port_info 0 /INPUT 1 "clk";
    .port_info 1 /INPUT 1 "rst";
    .port_info 2 /INPUT 1 "load_token_emb";
    .port_info 3 /INPUT 4 "load_token_idx";
    .port_info 4 /INPUT 2 "load_dim_idx";
    .port_info 5 /INPUT 16 "load_data";
    .port_info 6 /INPUT 1 "load_pos_emb";
    .port_info 7 /INPUT 3 "load_pos_idx";
    .port_info 8 /INPUT 1 "valid_in";
    .port_info 9 /INPUT 4 "token_id";
    .port_info 10 /INPUT 3 "position";
    .port_info 11 /OUTPUT 64 "emb_out";
    .port_info 12 /OUTPUT 1 "valid_out";
P_000001fa49bd92a0 .param/l "DATA_WIDTH" 0 9 12, +C4<00000000000000000000000000010000>;
P_000001fa49bd92d8 .param/l "EMBED_DIM" 0 9 11, +C4<00000000000000000000000000000100>;
P_000001fa49bd9310 .param/l "MAX_SEQ_LEN" 0 9 10, +C4<00000000000000000000000000001000>;
P_000001fa49bd9348 .param/l "VOCAB_SIZE" 0 9 9, +C4<00000000000000000000000000010000>;
v000001fa49c9c780_0 .net "clk", 0 0, v000001fa49c9fb90_0;  alias, 1 drivers
v000001fa49c9d7c0_0 .var "emb_out", 63 0;
v000001fa49c9cfa0_0 .var/i "i", 31 0;
v000001fa49c9dcc0_0 .net/s "load_data", 15 0, v000001fa49ca1ec0_0;  alias, 1 drivers
v000001fa49c9d860_0 .net "load_dim_idx", 1 0, v000001fa49ca11a0_0;  alias, 1 drivers
v000001fa49c9d900_0 .net "load_pos_emb", 0 0, v000001fa49ca1060_0;  alias, 1 drivers
v000001fa49c9db80_0 .net "load_pos_idx", 2 0, v000001fa49ca2000_0;  alias, 1 drivers
v000001fa49c9d540_0 .net "load_token_emb", 0 0, v000001fa49ca1d80_0;  alias, 1 drivers
v000001fa49c9d9a0_0 .net "load_token_idx", 3 0, v000001fa49ca1740_0;  alias, 1 drivers
v000001fa49c9ca00 .array/s "pos_table", 31 0, 15 0;
v000001fa49c9d220_0 .net "position", 2 0, v000001fa49ca1100_0;  alias, 1 drivers
v000001fa49c9da40_0 .net "rst", 0 0, v000001fa49ca1380_0;  alias, 1 drivers
v000001fa49c9d040_0 .net "token_id", 3 0, v000001fa49ca1e20_0;  alias, 1 drivers
v000001fa49c9cc80 .array/s "token_table", 63 0, 15 0;
v000001fa49c9d5e0_0 .net "valid_in", 0 0, L_000001fa49b6ddb0;  1 drivers
v000001fa49c9c6e0_0 .var "valid_out", 0 0;
S_000001fa49c8dc80 .scope module, "u_ln_final" "layer_norm" 4 106, 8 9 0, S_000001fa49a66960;
 .timescale 0 0;
    .port_info 0 /INPUT 1 "clk";
    .port_info 1 /INPUT 1 "rst";
    .port_info 2 /INPUT 1 "valid_in";
    .port_info 3 /INPUT 64 "x_in";
    .port_info 4 /INPUT 64 "gamma_in";
    .port_info 5 /INPUT 64 "beta_in";
    .port_info 6 /OUTPUT 64 "y_out";
    .port_info 7 /OUTPUT 1 "valid_out";
P_000001fa49c1e070 .param/l "CALC_INVSTD" 1 8 42, C4<0011>;
P_000001fa49c1e0a8 .param/l "CALC_MEAN" 1 8 40, C4<0001>;
P_000001fa49c1e0e0 .param/l "CALC_VAR" 1 8 41, C4<0010>;
P_000001fa49c1e118 .param/l "DATA_WIDTH" 0 8 11, +C4<00000000000000000000000000010000>;
P_000001fa49c1e150 .param/l "DIM" 0 8 10, +C4<00000000000000000000000000000100>;
P_000001fa49c1e188 .param/l "IDLE" 1 8 39, C4<0000>;
P_000001fa49c1e1c0 .param/l "NORMALIZE" 1 8 43, C4<0100>;
P_000001fa49c1e1f8 .param/l "OUTPUT" 1 8 44, C4<0101>;
v000001fa49c9dfe0 .array/s "beta", 3 0, 15 0;
v000001fa49c9dae0_0 .net "beta_in", 63 0, v000001fa49ca1ce0_0;  alias, 1 drivers
v000001fa49c9ce60_0 .net "clk", 0 0, v000001fa49c9fb90_0;  alias, 1 drivers
v000001fa49c9cf00_0 .var/s "diff", 15 0;
v000001fa49c9dc20 .array/s "gamma", 3 0, 15 0;
v000001fa49c9e080_0 .net "gamma_in", 63 0, v000001fa49ca1920_0;  alias, 1 drivers
v000001fa49c9c3c0_0 .var/i "i", 31 0;
v000001fa49c9d4a0_0 .var "idx", 2 0;
v000001fa49c9c280_0 .var/s "inv_std", 15 0;
v000001fa49c9d0e0_0 .var/s "mean_val", 15 0;
v000001fa49c9dea0_0 .var/s "norm_val", 31 0;
v000001fa49c9d180_0 .net "rst", 0 0, v000001fa49ca1380_0;  alias, 1 drivers
v000001fa49c9df40_0 .var/s "scaled", 31 0;
v000001fa49c9dd60_0 .var "state", 3 0;
v000001fa49c9caa0_0 .var/s "sum_acc", 23 0;
v000001fa49c9de00_0 .net "valid_in", 0 0, v000001fa49c9f730_0;  1 drivers
v000001fa49c9c320_0 .var "valid_out", 0 0;
v000001fa49c9c500_0 .var/s "var_acc", 31 0;
v000001fa49c9c640_0 .var/s "var_val", 15 0;
v000001fa49c9c820 .array/s "x_buf", 3 0, 15 0;
v000001fa49c9cb40_0 .net "x_in", 63 0, v000001fa49c9f0f0_0;  alias, 1 drivers
v000001fa49c8d020_0 .var "y_out", 63 0;
S_000001fa49c8dfa0 .scope function.vec4.u16, "approx_inv_sqrt" "approx_inv_sqrt" 8 51, 8 51 0, S_000001fa49c8dc80;
 .timescale 0 0;
v000001fa49c9c1e0_0 .var "abs_val", 15 0;
; Variable approx_inv_sqrt is vec4 return value of scope S_000001fa49c8dfa0
v000001fa49c9d400_0 .var/s "val", 15 0;
TD_gpt2_demo_tb.uut.u_ln_final.approx_inv_sqrt ;
    %load/vec4 v000001fa49c9d400_0;
    %pad/s 32;
    %cmpi/s 0, 0, 32;
    %flag_mov 8, 5;
    %jmp/0 T_9.47, 8;
    %load/vec4 v000001fa49c9d400_0;
    %inv;
    %pushi/vec4 1, 0, 16;
    %add;
    %jmp/1 T_9.48, 8;
T_9.47 ; End of true expr.
    %load/vec4 v000001fa49c9d400_0;
    %jmp/0 T_9.48, 8;
 ; End of false expr.
    %blend;
T_9.48;
    %store/vec4 v000001fa49c9c1e0_0, 0, 16;
    %load/vec4 v000001fa49c9c1e0_0;
    %pad/u 32;
    %cmpi/e 0, 0, 32;
    %jmp/0xz  T_9.49, 4;
    %pushi/vec4 256, 0, 16;
    %ret/vec4 0, 0, 16;  Assign to approx_inv_sqrt (store_vec4_to_lval)
    %jmp T_9.50;
T_9.49 ;
    %load/vec4 v000001fa49c9c1e0_0;
    %cmpi/u 64, 0, 16;
    %flag_or 5, 4;
    %jmp/0xz  T_9.51, 5;
    %pushi/vec4 512, 0, 16;
    %ret/vec4 0, 0, 16;  Assign to approx_inv_sqrt (store_vec4_to_lval)
    %jmp T_9.52;
T_9.51 ;
    %load/vec4 v000001fa49c9c1e0_0;
    %cmpi/u 256, 0, 16;
    %flag_or 5, 4;
    %jmp/0xz  T_9.53, 5;
    %pushi/vec4 256, 0, 16;
    %ret/vec4 0, 0, 16;  Assign to approx_inv_sqrt (store_vec4_to_lval)
    %jmp T_9.54;
T_9.53 ;
    %load/vec4 v000001fa49c9c1e0_0;
    %cmpi/u 1024, 0, 16;
    %flag_or 5, 4;
    %jmp/0xz  T_9.55, 5;
    %pushi/vec4 128, 0, 16;
    %ret/vec4 0, 0, 16;  Assign to approx_inv_sqrt (store_vec4_to_lval)
    %jmp T_9.56;
T_9.55 ;
    %pushi/vec4 64, 0, 16;
    %ret/vec4 0, 0, 16;  Assign to approx_inv_sqrt (store_vec4_to_lval)
T_9.56 ;
T_9.54 ;
T_9.52 ;
T_9.50 ;
    %end;
S_000001fa49c13150 .scope module, "linear_layer" "linear_layer" 10 8;
 .timescale 0 0;
    .port_info 0 /INPUT 1 "clk";
    .port_info 1 /INPUT 1 "rst";
    .port_info 2 /INPUT 1 "load_weight";
    .port_info 3 /INPUT 2 "w_row";
    .port_info 4 /INPUT 2 "w_col";
    .port_info 5 /INPUT 16 "w_data";
    .port_info 6 /INPUT 1 "load_bias";
    .port_info 7 /INPUT 2 "b_idx";
    .port_info 8 /INPUT 16 "b_data";
    .port_info 9 /INPUT 1 "valid_in";
    .port_info 10 /INPUT 64 "x_in";
    .port_info 11 /OUTPUT 64 "y_out";
    .port_info 12 /OUTPUT 1 "valid_out";
P_000001fa49abe2a0 .param/l "ACC_WIDTH" 0 10 12, +C4<00000000000000000000000000100000>;
P_000001fa49abe2d8 .param/l "COMPUTE" 1 10 45, C4<0001>;
P_000001fa49abe310 .param/l "DATA_WIDTH" 0 10 11, +C4<00000000000000000000000000010000>;
P_000001fa49abe348 .param/l "DONE" 1 10 46, C4<0010>;
P_000001fa49abe380 .param/l "IDLE" 1 10 44, C4<0000>;
P_000001fa49abe3b8 .param/l "IN_DIM" 0 10 9, +C4<00000000000000000000000000000100>;
P_000001fa49abe3f0 .param/l "OUT_DIM" 0 10 10, +C4<00000000000000000000000000000100>;
v000001fa49ca0ca0_0 .var/s "accum", 31 0;
o000001fa49c3e218 .functor BUFZ 16, C4<zzzzzzzzzzzzzzzz>; HiZ drive
v000001fa49ca1a60_0 .net/s "b_data", 15 0, o000001fa49c3e218;  0 drivers
o000001fa49c3e248 .functor BUFZ 2, C4<zz>; HiZ drive
v000001fa49ca02a0_0 .net "b_idx", 1 0, o000001fa49c3e248;  0 drivers
v000001fa49ca1b00 .array/s "bias", 3 0, 15 0;
o000001fa49c3e278 .functor BUFZ 1, C4<z>; HiZ drive
v000001fa49ca0840_0 .net "clk", 0 0, o000001fa49c3e278;  0 drivers
v000001fa49ca0480_0 .var/i "i", 31 0;
v000001fa49ca0ac0_0 .var/i "j", 31 0;
o000001fa49c3e308 .functor BUFZ 1, C4<z>; HiZ drive
v000001fa49ca1420_0 .net "load_bias", 0 0, o000001fa49c3e308;  0 drivers
o000001fa49c3e338 .functor BUFZ 1, C4<z>; HiZ drive
v000001fa49ca0340_0 .net "load_weight", 0 0, o000001fa49c3e338;  0 drivers
v000001fa49ca03e0_0 .var "out_idx", 2 0;
v000001fa49ca0d40_0 .var/s "product", 31 0;
o000001fa49c3e3c8 .functor BUFZ 1, C4<z>; HiZ drive
v000001fa49ca0520_0 .net "rst", 0 0, o000001fa49c3e3c8;  0 drivers
v000001fa49ca1ba0_0 .var "state", 3 0;
o000001fa49c3e428 .functor BUFZ 1, C4<z>; HiZ drive
v000001fa49ca05c0_0 .net "valid_in", 0 0, o000001fa49c3e428;  0 drivers
v000001fa49ca0660_0 .var "valid_out", 0 0;
o000001fa49c3e488 .functor BUFZ 2, C4<zz>; HiZ drive
v000001fa49ca0700_0 .net "w_col", 1 0, o000001fa49c3e488;  0 drivers
o000001fa49c3e4b8 .functor BUFZ 16, C4<zzzzzzzzzzzzzzzz>; HiZ drive
v000001fa49ca08e0_0 .net/s "w_data", 15 0, o000001fa49c3e4b8;  0 drivers
o000001fa49c3e4e8 .functor BUFZ 2, C4<zz>; HiZ drive
v000001fa49ca0a20_0 .net "w_row", 1 0, o000001fa49c3e4e8;  0 drivers
v000001fa49ca0b60 .array/s "weights", 15 0, 15 0;
v000001fa49ca14c0 .array/s "x_buf", 3 0, 15 0;
o000001fa49c3e518 .functor BUFZ 64, C4<zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz>; HiZ drive
v000001fa49ca0c00_0 .net "x_in", 63 0, o000001fa49c3e518;  0 drivers
v000001fa49ca0de0_0 .var "y_out", 63 0;
E_000001fa49c2cc40 .event posedge, v000001fa49ca0840_0;
S_000001fa49abe430 .scope module, "softmax_unit" "softmax_unit" 11 14;
 .timescale 0 0;
    .port_info 0 /INPUT 1 "clk";
    .port_info 1 /INPUT 1 "rst";
    .port_info 2 /INPUT 1 "valid_in";
    .port_info 3 /INPUT 128 "x_in";
    .port_info 4 /OUTPUT 64 "prob_out";
    .port_info 5 /OUTPUT 1 "valid_out";
P_000001fa49b3b960 .param/l "COMPUTE" 1 11 42, C4<0010>;
P_000001fa49b3b998 .param/l "DATA_WIDTH" 0 11 16, +C4<00000000000000000000000000010000>;
P_000001fa49b3b9d0 .param/l "FIND_MAX" 1 11 41, C4<0001>;
P_000001fa49b3ba08 .param/l "IDLE" 1 11 40, C4<0000>;
P_000001fa49b3ba40 .param/l "NORMALIZE" 1 11 43, C4<0011>;
P_000001fa49b3ba78 .param/l "OUTPUT" 1 11 44, C4<0100>;
P_000001fa49b3bab0 .param/l "VECTOR_LEN" 0 11 15, +C4<00000000000000000000000000001000>;
o000001fa49c3e878 .functor BUFZ 1, C4<z>; HiZ drive
v000001fa49ca0fc0_0 .net "clk", 0 0, o000001fa49c3e878;  0 drivers
v000001fa49ca2d50_0 .var "div_result", 15 0;
v000001fa49ca32f0_0 .var "exp_sum", 15 0;
v000001fa49ca2c10 .array "exp_val", 7 0, 7 0;
v000001fa49ca2b70_0 .var/i "i", 31 0;
v000001fa49ca2df0_0 .var "idx", 3 0;
v000001fa49ca2cb0_0 .var/s "max_val", 15 0;
v000001fa49ca3d90_0 .var "prob_out", 63 0;
o000001fa49c3e9c8 .functor BUFZ 1, C4<z>; HiZ drive
v000001fa49ca3110_0 .net "rst", 0 0, o000001fa49c3e9c8;  0 drivers
v000001fa49ca39d0_0 .var/s "shifted", 15 0;
v000001fa49ca36b0_0 .var "state", 3 0;
o000001fa49c3ea58 .functor BUFZ 1, C4<z>; HiZ drive
v000001fa49ca3610_0 .net "valid_in", 0 0, o000001fa49c3ea58;  0 drivers
v000001fa49ca3c50_0 .var "valid_out", 0 0;
v000001fa49ca22b0 .array/s "x_buf", 7 0, 15 0;
o000001fa49c3eab8 .functor BUFZ 128, C4<zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz>; HiZ drive
v000001fa49ca2fd0_0 .net "x_in", 127 0, o000001fa49c3eab8;  0 drivers
E_000001fa49c2ccc0 .event posedge, v000001fa49ca0fc0_0;
S_000001fa49c8d320 .scope function.vec4.s8, "exp_approx" "exp_approx" 11 53, 11 53 0, S_000001fa49abe430;
 .timescale 0 0;
; Variable exp_approx is vec4 return value of scope S_000001fa49c8d320
v000001fa49ca0f20_0 .var/s "tmp", 19 0;
v000001fa49ca1560_0 .var/s "val", 15 0;
TD_softmax_unit.exp_approx ;
    %load/vec4 v000001fa49ca1560_0;
    %pad/s 32;
    %cmpi/s 0, 0, 32;
    %flag_inv 5; GE is !LT
    %jmp/0xz  T_10.57, 5;
    %pushi/vec4 255, 0, 8;
    %ret/vec4 0, 0, 8;  Assign to exp_approx (store_vec4_to_lval)
    %jmp T_10.58;
T_10.57 ;
    %load/vec4 v000001fa49ca1560_0;
    %cmpi/s 64512, 0, 16;
    %jmp/0xz  T_10.59, 5;
    %pushi/vec4 1, 0, 8;
    %ret/vec4 0, 0, 8;  Assign to exp_approx (store_vec4_to_lval)
    %jmp T_10.60;
T_10.59 ;
    %pushi/vec4 255, 0, 32;
    %load/vec4 v000001fa49ca1560_0;
    %pad/s 32;
    %muli 64, 0, 32;
    %pushi/vec4 256, 0, 32;
    %div/s;
    %add;
    %pad/s 20;
    %store/vec4 v000001fa49ca0f20_0, 0, 20;
    %load/vec4 v000001fa49ca0f20_0;
    %pad/s 32;
    %cmpi/s 1, 0, 32;
    %jmp/0xz  T_10.61, 5;
    %pushi/vec4 1, 0, 8;
    %ret/vec4 0, 0, 8;  Assign to exp_approx (store_vec4_to_lval)
    %jmp T_10.62;
T_10.61 ;
    %load/vec4 v000001fa49ca0f20_0;
    %pad/s 32;
    %cmpi/s 255, 0, 32;
    %flag_or 5, 4; GT is !LE
    %flag_inv 5;
    %jmp/0xz  T_10.63, 5;
    %pushi/vec4 255, 0, 8;
    %ret/vec4 0, 0, 8;  Assign to exp_approx (store_vec4_to_lval)
    %jmp T_10.64;
T_10.63 ;
    %load/vec4 v000001fa49ca0f20_0;
    %parti/s 8, 0, 2;
    %ret/vec4 0, 0, 8;  Assign to exp_approx (store_vec4_to_lval)
T_10.64 ;
T_10.62 ;
T_10.60 ;
T_10.58 ;
    %end;
    .scope S_000001fa49bdc350;
T_11 ;
    %wait E_000001fa49c2cf00;
    %load/vec4 v000001fa49bf1bb0_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_11.0, 8;
    %pushi/vec4 0, 0, 16;
    %assign/vec4 v000001fa49bf2330_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49bf21f0_0, 0;
    %jmp T_11.1;
T_11.0 ;
    %load/vec4 v000001fa49bf1c50_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_11.2, 8;
    %load/vec4 v000001fa49bf2290_0;
    %cmpi/s 64768, 0, 16;
    %jmp/0xz  T_11.4, 5;
    %pushi/vec4 0, 0, 16;
    %assign/vec4 v000001fa49bf2330_0, 0;
    %jmp T_11.5;
T_11.4 ;
    %load/vec4 v000001fa49bf2290_0;
    %cmpi/s 768, 0, 16;
    %flag_or 5, 4; GT is !LE
    %flag_inv 5;
    %jmp/0xz  T_11.6, 5;
    %load/vec4 v000001fa49bf2290_0;
    %assign/vec4 v000001fa49bf2330_0, 0;
    %jmp T_11.7;
T_11.6 ;
    %load/vec4 v000001fa49bf2290_0;
    %pad/s 32;
    %muli 43, 0, 32;
    %store/vec4 v000001fa49bf1e30_0, 0, 32;
    %pushi/vec4 128, 0, 16;
    %load/vec4 v000001fa49bf1e30_0;
    %parti/s 16, 8, 5;
    %add;
    %store/vec4 v000001fa49bf2790_0, 0, 16;
    %load/vec4 v000001fa49bf2290_0;
    %pad/s 32;
    %load/vec4 v000001fa49bf2790_0;
    %pad/s 32;
    %mul;
    %store/vec4 v000001fa49bf26f0_0, 0, 32;
    %load/vec4 v000001fa49bf26f0_0;
    %parti/s 16, 8, 5;
    %assign/vec4 v000001fa49bf2330_0, 0;
T_11.7 ;
T_11.5 ;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v000001fa49bf21f0_0, 0;
    %jmp T_11.3;
T_11.2 ;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49bf21f0_0, 0;
T_11.3 ;
T_11.1 ;
    %jmp T_11;
    .thread T_11;
    .scope S_000001fa49c8daf0;
T_12 ;
    %wait E_000001fa49c2d000;
    %load/vec4 v000001fa49c9da40_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_12.0, 8;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c9cfa0_0, 0, 32;
T_12.2 ;
    %load/vec4 v000001fa49c9cfa0_0;
    %cmpi/s 64, 0, 32;
    %jmp/0xz T_12.3, 5;
    %pushi/vec4 0, 0, 16;
    %load/vec4 v000001fa49c9cfa0_0;
    %pushi/vec4 4, 0, 32;
    %div/s;
    %pad/s 35;
    %pad/s 37;
    %muli 4, 0, 37;
    %pad/s 38;
    %load/vec4 v000001fa49c9cfa0_0;
    %pushi/vec4 4, 0, 32;
    %mod/s;
    %pad/s 38;
    %add;
    %ix/vec4/s 3;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c9cc80, 0, 4;
    %load/vec4 v000001fa49c9cfa0_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c9cfa0_0, 0, 32;
    %jmp T_12.2;
T_12.3 ;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c9cfa0_0, 0, 32;
T_12.4 ;
    %load/vec4 v000001fa49c9cfa0_0;
    %cmpi/s 32, 0, 32;
    %jmp/0xz T_12.5, 5;
    %pushi/vec4 0, 0, 16;
    %load/vec4 v000001fa49c9cfa0_0;
    %pushi/vec4 4, 0, 32;
    %div/s;
    %pad/s 35;
    %pad/s 37;
    %muli 4, 0, 37;
    %pad/s 38;
    %load/vec4 v000001fa49c9cfa0_0;
    %pushi/vec4 4, 0, 32;
    %mod/s;
    %pad/s 38;
    %add;
    %ix/vec4/s 3;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c9ca00, 0, 4;
    %load/vec4 v000001fa49c9cfa0_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c9cfa0_0, 0, 32;
    %jmp T_12.4;
T_12.5 ;
    %jmp T_12.1;
T_12.0 ;
    %load/vec4 v000001fa49c9d540_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_12.6, 8;
    %load/vec4 v000001fa49c9dcc0_0;
    %load/vec4 v000001fa49c9d9a0_0;
    %pad/u 9;
    %pad/u 11;
    %muli 4, 0, 11;
    %pad/u 12;
    %load/vec4 v000001fa49c9d860_0;
    %pad/u 4;
    %pad/u 12;
    %add;
    %ix/vec4 3;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c9cc80, 0, 4;
T_12.6 ;
    %load/vec4 v000001fa49c9d900_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_12.8, 8;
    %load/vec4 v000001fa49c9dcc0_0;
    %load/vec4 v000001fa49c9db80_0;
    %pad/u 8;
    %pad/u 10;
    %muli 4, 0, 10;
    %pad/u 11;
    %load/vec4 v000001fa49c9d860_0;
    %pad/u 4;
    %pad/u 11;
    %add;
    %ix/vec4 3;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c9ca00, 0, 4;
T_12.8 ;
T_12.1 ;
    %jmp T_12;
    .thread T_12;
    .scope S_000001fa49c8daf0;
T_13 ;
    %wait E_000001fa49c2d000;
    %load/vec4 v000001fa49c9da40_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_13.0, 8;
    %pushi/vec4 0, 0, 64;
    %assign/vec4 v000001fa49c9d7c0_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9c6e0_0, 0;
    %jmp T_13.1;
T_13.0 ;
    %load/vec4 v000001fa49c9d5e0_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_13.2, 8;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c9cfa0_0, 0, 32;
T_13.4 ;
    %load/vec4 v000001fa49c9cfa0_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_13.5, 5;
    %load/vec4 v000001fa49c9d040_0;
    %pad/u 9;
    %pad/u 11;
    %muli 4, 0, 11;
    %pad/u 12;
    %load/vec4 v000001fa49c9cfa0_0;
    %pad/s 12;
    %add;
    %ix/vec4 4;
    %load/vec4a v000001fa49c9cc80, 4;
    %load/vec4 v000001fa49c9d220_0;
    %pad/u 8;
    %pad/u 10;
    %muli 4, 0, 10;
    %pad/u 11;
    %load/vec4 v000001fa49c9cfa0_0;
    %pad/s 11;
    %add;
    %ix/vec4 4;
    %load/vec4a v000001fa49c9ca00, 4;
    %add;
    %ix/load 5, 0, 0;
    %load/vec4 v000001fa49c9cfa0_0;
    %muli 16, 0, 32;
    %ix/vec4/s 4;
    %assign/vec4/off/d v000001fa49c9d7c0_0, 4, 5;
    %load/vec4 v000001fa49c9cfa0_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c9cfa0_0, 0, 32;
    %jmp T_13.4;
T_13.5 ;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v000001fa49c9c6e0_0, 0;
    %jmp T_13.3;
T_13.2 ;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9c6e0_0, 0;
T_13.3 ;
T_13.1 ;
    %jmp T_13;
    .thread T_13;
    .scope S_000001fa49c8d190;
T_14 ;
    %wait E_000001fa49c2d000;
    %load/vec4 v000001fa49c8ff00_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_14.0, 8;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49c8e560_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c8e740_0, 0;
    %pushi/vec4 0, 0, 24;
    %assign/vec4 v000001fa49c8e600_0, 0;
    %pushi/vec4 0, 0, 32;
    %assign/vec4 v000001fa49c8e7e0_0, 0;
    %pushi/vec4 0, 0, 3;
    %assign/vec4 v000001fa49c8fe60_0, 0;
    %pushi/vec4 0, 0, 64;
    %assign/vec4 v000001fa49c8ece0_0, 0;
    %jmp T_14.1;
T_14.0 ;
    %load/vec4 v000001fa49c8e560_0;
    %dup/vec4;
    %pushi/vec4 0, 0, 4;
    %cmp/u;
    %jmp/1 T_14.2, 6;
    %dup/vec4;
    %pushi/vec4 1, 0, 4;
    %cmp/u;
    %jmp/1 T_14.3, 6;
    %dup/vec4;
    %pushi/vec4 2, 0, 4;
    %cmp/u;
    %jmp/1 T_14.4, 6;
    %dup/vec4;
    %pushi/vec4 3, 0, 4;
    %cmp/u;
    %jmp/1 T_14.5, 6;
    %dup/vec4;
    %pushi/vec4 4, 0, 4;
    %cmp/u;
    %jmp/1 T_14.6, 6;
    %dup/vec4;
    %pushi/vec4 5, 0, 4;
    %cmp/u;
    %jmp/1 T_14.7, 6;
    %jmp T_14.8;
T_14.2 ;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c8e740_0, 0;
    %load/vec4 v000001fa49c8e6a0_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_14.9, 8;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8fd20_0, 0, 32;
T_14.11 ;
    %load/vec4 v000001fa49c8fd20_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_14.12, 5;
    %load/vec4 v000001fa49c8eba0_0;
    %load/vec4 v000001fa49c8fd20_0;
    %muli 16, 0, 32;
    %part/s 16;
    %ix/getv/s 3, v000001fa49c8fd20_0;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c8e9c0, 0, 4;
    %load/vec4 v000001fa49c8f0a0_0;
    %load/vec4 v000001fa49c8fd20_0;
    %muli 16, 0, 32;
    %part/s 16;
    %ix/getv/s 3, v000001fa49c8fd20_0;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c8e880, 0, 4;
    %load/vec4 v000001fa49c8e420_0;
    %load/vec4 v000001fa49c8fd20_0;
    %muli 16, 0, 32;
    %part/s 16;
    %ix/getv/s 3, v000001fa49c8fd20_0;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c8e380, 0, 4;
    %load/vec4 v000001fa49c8fd20_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8fd20_0, 0, 32;
    %jmp T_14.11;
T_14.12 ;
    %pushi/vec4 0, 0, 24;
    %assign/vec4 v000001fa49c8e600_0, 0;
    %pushi/vec4 0, 0, 3;
    %assign/vec4 v000001fa49c8fe60_0, 0;
    %pushi/vec4 1, 0, 4;
    %assign/vec4 v000001fa49c8e560_0, 0;
T_14.9 ;
    %jmp T_14.8;
T_14.3 ;
    %load/vec4 v000001fa49c8fe60_0;
    %pad/u 32;
    %cmpi/u 4, 0, 32;
    %jmp/0xz  T_14.13, 5;
    %load/vec4 v000001fa49c8e600_0;
    %load/vec4 v000001fa49c8fe60_0;
    %pad/u 4;
    %ix/vec4 4;
    %load/vec4a v000001fa49c8e9c0, 4;
    %parti/s 1, 15, 5;
    %replicate 8;
    %load/vec4 v000001fa49c8fe60_0;
    %pad/u 4;
    %ix/vec4 4;
    %load/vec4a v000001fa49c8e9c0, 4;
    %concat/vec4; draw_concat_vec4
    %add;
    %assign/vec4 v000001fa49c8e600_0, 0;
    %load/vec4 v000001fa49c8fe60_0;
    %addi 1, 0, 3;
    %assign/vec4 v000001fa49c8fe60_0, 0;
    %jmp T_14.14;
T_14.13 ;
    %load/vec4 v000001fa49c8e600_0;
    %pad/s 32;
    %pushi/vec4 4, 0, 32;
    %div/s;
    %pad/s 16;
    %assign/vec4 v000001fa49c8f500_0, 0;
    %pushi/vec4 0, 0, 32;
    %assign/vec4 v000001fa49c8e7e0_0, 0;
    %pushi/vec4 0, 0, 3;
    %assign/vec4 v000001fa49c8fe60_0, 0;
    %pushi/vec4 2, 0, 4;
    %assign/vec4 v000001fa49c8e560_0, 0;
T_14.14 ;
    %jmp T_14.8;
T_14.4 ;
    %load/vec4 v000001fa49c8fe60_0;
    %pad/u 32;
    %cmpi/u 4, 0, 32;
    %jmp/0xz  T_14.15, 5;
    %load/vec4 v000001fa49c8fe60_0;
    %pad/u 4;
    %ix/vec4 4;
    %load/vec4a v000001fa49c8e9c0, 4;
    %load/vec4 v000001fa49c8f500_0;
    %sub;
    %store/vec4 v000001fa49c8ed80_0, 0, 16;
    %load/vec4 v000001fa49c8e7e0_0;
    %load/vec4 v000001fa49c8ed80_0;
    %pad/s 32;
    %load/vec4 v000001fa49c8ed80_0;
    %pad/s 32;
    %mul;
    %add;
    %assign/vec4 v000001fa49c8e7e0_0, 0;
    %load/vec4 v000001fa49c8fe60_0;
    %addi 1, 0, 3;
    %assign/vec4 v000001fa49c8fe60_0, 0;
    %jmp T_14.16;
T_14.15 ;
    %load/vec4 v000001fa49c8e7e0_0;
    %parti/s 16, 8, 5;
    %pad/u 32;
    %pushi/vec4 4, 0, 32;
    %div;
    %pad/u 16;
    %assign/vec4 v000001fa49c8e920_0, 0;
    %pushi/vec4 3, 0, 4;
    %assign/vec4 v000001fa49c8e560_0, 0;
T_14.16 ;
    %jmp T_14.8;
T_14.5 ;
    %load/vec4 v000001fa49c8e920_0;
    %store/vec4 v000001fa49c8f460_0, 0, 16;
    %callf/vec4 TD_gpt2_demo_tb.uut.u_block.u_ln1.approx_inv_sqrt, S_000001fa49c8de10;
    %assign/vec4 v000001fa49c8f140_0, 0;
    %pushi/vec4 0, 0, 3;
    %assign/vec4 v000001fa49c8fe60_0, 0;
    %pushi/vec4 4, 0, 4;
    %assign/vec4 v000001fa49c8e560_0, 0;
    %jmp T_14.8;
T_14.6 ;
    %load/vec4 v000001fa49c8fe60_0;
    %pad/u 32;
    %cmpi/u 4, 0, 32;
    %jmp/0xz  T_14.17, 5;
    %load/vec4 v000001fa49c8fe60_0;
    %pad/u 4;
    %ix/vec4 4;
    %load/vec4a v000001fa49c8e9c0, 4;
    %load/vec4 v000001fa49c8f500_0;
    %sub;
    %store/vec4 v000001fa49c8ed80_0, 0, 16;
    %load/vec4 v000001fa49c8ed80_0;
    %pad/s 32;
    %load/vec4 v000001fa49c8f140_0;
    %pad/s 32;
    %mul;
    %store/vec4 v000001fa49c8f640_0, 0, 32;
    %load/vec4 v000001fa49c8fe60_0;
    %pad/u 4;
    %ix/vec4 4;
    %load/vec4a v000001fa49c8e880, 4;
    %pad/u 32;
    %load/vec4 v000001fa49c8f640_0;
    %parti/s 16, 8, 5;
    %pad/u 32;
    %mul;
    %store/vec4 v000001fa49c8e4c0_0, 0, 32;
    %load/vec4 v000001fa49c8e4c0_0;
    %parti/s 16, 8, 5;
    %load/vec4 v000001fa49c8fe60_0;
    %pad/u 4;
    %ix/vec4 4;
    %load/vec4a v000001fa49c8e380, 4;
    %add;
    %ix/load 5, 0, 0;
    %load/vec4 v000001fa49c8fe60_0;
    %pad/u 32;
    %muli 16, 0, 32;
    %ix/vec4 4;
    %assign/vec4/off/d v000001fa49c8ece0_0, 4, 5;
    %load/vec4 v000001fa49c8fe60_0;
    %addi 1, 0, 3;
    %assign/vec4 v000001fa49c8fe60_0, 0;
    %jmp T_14.18;
T_14.17 ;
    %pushi/vec4 5, 0, 4;
    %assign/vec4 v000001fa49c8e560_0, 0;
T_14.18 ;
    %jmp T_14.8;
T_14.7 ;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v000001fa49c8e740_0, 0;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49c8e560_0, 0;
    %jmp T_14.8;
T_14.8 ;
    %pop/vec4 1;
T_14.1 ;
    %jmp T_14;
    .thread T_14;
    .scope S_000001fa49c1c370;
T_15 ;
    %wait E_000001fa49c2d000;
    %load/vec4 v000001fa49c8b540_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_15.0, 8;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49c8b5e0_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c8bb80_0, 0;
    %pushi/vec4 0, 0, 64;
    %assign/vec4 v000001fa49c8c1c0_0, 0;
    %jmp T_15.1;
T_15.0 ;
    %load/vec4 v000001fa49c8b5e0_0;
    %dup/vec4;
    %pushi/vec4 0, 0, 4;
    %cmp/u;
    %jmp/1 T_15.2, 6;
    %dup/vec4;
    %pushi/vec4 2, 0, 4;
    %cmp/u;
    %jmp/1 T_15.3, 6;
    %dup/vec4;
    %pushi/vec4 3, 0, 4;
    %cmp/u;
    %jmp/1 T_15.4, 6;
    %dup/vec4;
    %pushi/vec4 4, 0, 4;
    %cmp/u;
    %jmp/1 T_15.5, 6;
    %dup/vec4;
    %pushi/vec4 5, 0, 4;
    %cmp/u;
    %jmp/1 T_15.6, 6;
    %jmp T_15.7;
T_15.2 ;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c8bb80_0, 0;
    %load/vec4 v000001fa49c8bae0_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_15.8, 8;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8b360_0, 0, 32;
T_15.10 ;
    %load/vec4 v000001fa49c8b360_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_15.11, 5;
    %load/vec4 v000001fa49c8c120_0;
    %load/vec4 v000001fa49c8b360_0;
    %muli 16, 0, 32;
    %part/s 16;
    %ix/getv/s 3, v000001fa49c8b360_0;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c8c300, 0, 4;
    %load/vec4 v000001fa49c8b360_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8b360_0, 0, 32;
    %jmp T_15.10;
T_15.11 ;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8b360_0, 0, 32;
T_15.12 ;
    %load/vec4 v000001fa49c8b360_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_15.13, 5;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8cd00_0, 0, 32;
T_15.14 ;
    %load/vec4 v000001fa49c8cd00_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_15.15, 5;
    %load/vec4 v000001fa49c8bfe0_0;
    %load/vec4 v000001fa49c8b360_0;
    %muli 4, 0, 32;
    %load/vec4 v000001fa49c8cd00_0;
    %add;
    %muli 16, 0, 32;
    %part/s 16;
    %load/vec4 v000001fa49c8b360_0;
    %pad/s 35;
    %pad/s 37;
    %muli 4, 0, 37;
    %pad/s 38;
    %load/vec4 v000001fa49c8cd00_0;
    %pad/s 38;
    %add;
    %ix/vec4/s 3;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c8be00, 0, 4;
    %load/vec4 v000001fa49c8c8a0_0;
    %load/vec4 v000001fa49c8b360_0;
    %muli 4, 0, 32;
    %load/vec4 v000001fa49c8cd00_0;
    %add;
    %muli 16, 0, 32;
    %part/s 16;
    %load/vec4 v000001fa49c8b360_0;
    %pad/s 35;
    %pad/s 37;
    %muli 4, 0, 37;
    %pad/s 38;
    %load/vec4 v000001fa49c8cd00_0;
    %pad/s 38;
    %add;
    %ix/vec4/s 3;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c8bc20, 0, 4;
    %load/vec4 v000001fa49c8c080_0;
    %load/vec4 v000001fa49c8b360_0;
    %muli 4, 0, 32;
    %load/vec4 v000001fa49c8cd00_0;
    %add;
    %muli 16, 0, 32;
    %part/s 16;
    %load/vec4 v000001fa49c8b360_0;
    %pad/s 35;
    %pad/s 37;
    %muli 4, 0, 37;
    %pad/s 38;
    %load/vec4 v000001fa49c8cd00_0;
    %pad/s 38;
    %add;
    %ix/vec4/s 3;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c8bea0, 0, 4;
    %load/vec4 v000001fa49c8bd60_0;
    %load/vec4 v000001fa49c8b360_0;
    %muli 4, 0, 32;
    %load/vec4 v000001fa49c8cd00_0;
    %add;
    %muli 16, 0, 32;
    %part/s 16;
    %load/vec4 v000001fa49c8b360_0;
    %pad/s 35;
    %pad/s 37;
    %muli 4, 0, 37;
    %pad/s 38;
    %load/vec4 v000001fa49c8cd00_0;
    %pad/s 38;
    %add;
    %ix/vec4/s 3;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c8bcc0, 0, 4;
    %load/vec4 v000001fa49c8cd00_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8cd00_0, 0, 32;
    %jmp T_15.14;
T_15.15 ;
    %load/vec4 v000001fa49c8b360_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8b360_0, 0, 32;
    %jmp T_15.12;
T_15.13 ;
    %pushi/vec4 2, 0, 4;
    %assign/vec4 v000001fa49c8b5e0_0, 0;
T_15.8 ;
    %jmp T_15.7;
T_15.3 ;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8cd00_0, 0, 32;
T_15.16 ;
    %load/vec4 v000001fa49c8cd00_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_15.17, 5;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8cc60_0, 0, 32;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8b360_0, 0, 32;
T_15.18 ;
    %load/vec4 v000001fa49c8b360_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_15.19, 5;
    %ix/getv/s 4, v000001fa49c8b360_0;
    %load/vec4a v000001fa49c8c300, 4;
    %pad/s 32;
    %load/vec4 v000001fa49c8b360_0;
    %pad/s 35;
    %pad/s 37;
    %muli 4, 0, 37;
    %pad/s 38;
    %load/vec4 v000001fa49c8cd00_0;
    %pad/s 38;
    %add;
    %ix/vec4/s 4;
    %load/vec4a v000001fa49c8be00, 4;
    %pad/s 32;
    %mul;
    %store/vec4 v000001fa49c8b4a0_0, 0, 32;
    %load/vec4 v000001fa49c8cc60_0;
    %load/vec4 v000001fa49c8b4a0_0;
    %add;
    %store/vec4 v000001fa49c8cc60_0, 0, 32;
    %load/vec4 v000001fa49c8b360_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8b360_0, 0, 32;
    %jmp T_15.18;
T_15.19 ;
    %load/vec4 v000001fa49c8cc60_0;
    %parti/s 16, 8, 5;
    %ix/getv/s 4, v000001fa49c8cd00_0;
    %store/vec4a v000001fa49c8c800, 4, 0;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8cc60_0, 0, 32;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8b360_0, 0, 32;
T_15.20 ;
    %load/vec4 v000001fa49c8b360_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_15.21, 5;
    %ix/getv/s 4, v000001fa49c8b360_0;
    %load/vec4a v000001fa49c8c300, 4;
    %pad/s 32;
    %load/vec4 v000001fa49c8b360_0;
    %pad/s 35;
    %pad/s 37;
    %muli 4, 0, 37;
    %pad/s 38;
    %load/vec4 v000001fa49c8cd00_0;
    %pad/s 38;
    %add;
    %ix/vec4/s 4;
    %load/vec4a v000001fa49c8bc20, 4;
    %pad/s 32;
    %mul;
    %store/vec4 v000001fa49c8b4a0_0, 0, 32;
    %load/vec4 v000001fa49c8cc60_0;
    %load/vec4 v000001fa49c8b4a0_0;
    %add;
    %store/vec4 v000001fa49c8cc60_0, 0, 32;
    %load/vec4 v000001fa49c8b360_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8b360_0, 0, 32;
    %jmp T_15.20;
T_15.21 ;
    %load/vec4 v000001fa49c8cc60_0;
    %parti/s 16, 8, 5;
    %ix/getv/s 4, v000001fa49c8cd00_0;
    %store/vec4a v000001fa49c8b900, 4, 0;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8cc60_0, 0, 32;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8b360_0, 0, 32;
T_15.22 ;
    %load/vec4 v000001fa49c8b360_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_15.23, 5;
    %ix/getv/s 4, v000001fa49c8b360_0;
    %load/vec4a v000001fa49c8c300, 4;
    %pad/s 32;
    %load/vec4 v000001fa49c8b360_0;
    %pad/s 35;
    %pad/s 37;
    %muli 4, 0, 37;
    %pad/s 38;
    %load/vec4 v000001fa49c8cd00_0;
    %pad/s 38;
    %add;
    %ix/vec4/s 4;
    %load/vec4a v000001fa49c8bea0, 4;
    %pad/s 32;
    %mul;
    %store/vec4 v000001fa49c8b4a0_0, 0, 32;
    %load/vec4 v000001fa49c8cc60_0;
    %load/vec4 v000001fa49c8b4a0_0;
    %add;
    %store/vec4 v000001fa49c8cc60_0, 0, 32;
    %load/vec4 v000001fa49c8b360_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8b360_0, 0, 32;
    %jmp T_15.22;
T_15.23 ;
    %load/vec4 v000001fa49c8cc60_0;
    %parti/s 16, 8, 5;
    %ix/getv/s 4, v000001fa49c8cd00_0;
    %store/vec4a v000001fa49c8b7c0, 4, 0;
    %load/vec4 v000001fa49c8cd00_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8cd00_0, 0, 32;
    %jmp T_15.16;
T_15.17 ;
    %pushi/vec4 3, 0, 4;
    %assign/vec4 v000001fa49c8b5e0_0, 0;
    %jmp T_15.7;
T_15.4 ;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8b360_0, 0, 32;
T_15.24 ;
    %load/vec4 v000001fa49c8b360_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_15.25, 5;
    %ix/getv/s 4, v000001fa49c8b360_0;
    %load/vec4a v000001fa49c8b7c0, 4;
    %ix/getv/s 4, v000001fa49c8b360_0;
    %store/vec4a v000001fa49c8b220, 4, 0;
    %load/vec4 v000001fa49c8b360_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8b360_0, 0, 32;
    %jmp T_15.24;
T_15.25 ;
    %pushi/vec4 4, 0, 4;
    %assign/vec4 v000001fa49c8b5e0_0, 0;
    %jmp T_15.7;
T_15.5 ;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8cd00_0, 0, 32;
T_15.26 ;
    %load/vec4 v000001fa49c8cd00_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_15.27, 5;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8cc60_0, 0, 32;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8b360_0, 0, 32;
T_15.28 ;
    %load/vec4 v000001fa49c8b360_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_15.29, 5;
    %ix/getv/s 4, v000001fa49c8b360_0;
    %load/vec4a v000001fa49c8b220, 4;
    %pad/s 32;
    %load/vec4 v000001fa49c8b360_0;
    %pad/s 35;
    %pad/s 37;
    %muli 4, 0, 37;
    %pad/s 38;
    %load/vec4 v000001fa49c8cd00_0;
    %pad/s 38;
    %add;
    %ix/vec4/s 4;
    %load/vec4a v000001fa49c8bcc0, 4;
    %pad/s 32;
    %mul;
    %store/vec4 v000001fa49c8b4a0_0, 0, 32;
    %load/vec4 v000001fa49c8cc60_0;
    %load/vec4 v000001fa49c8b4a0_0;
    %add;
    %store/vec4 v000001fa49c8cc60_0, 0, 32;
    %load/vec4 v000001fa49c8b360_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8b360_0, 0, 32;
    %jmp T_15.28;
T_15.29 ;
    %load/vec4 v000001fa49c8cc60_0;
    %parti/s 16, 8, 5;
    %ix/load 5, 0, 0;
    %load/vec4 v000001fa49c8cd00_0;
    %muli 16, 0, 32;
    %ix/vec4/s 4;
    %assign/vec4/off/d v000001fa49c8c1c0_0, 4, 5;
    %load/vec4 v000001fa49c8cd00_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8cd00_0, 0, 32;
    %jmp T_15.26;
T_15.27 ;
    %pushi/vec4 5, 0, 4;
    %assign/vec4 v000001fa49c8b5e0_0, 0;
    %jmp T_15.7;
T_15.6 ;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v000001fa49c8bb80_0, 0;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49c8b5e0_0, 0;
    %jmp T_15.7;
T_15.7 ;
    %pop/vec4 1;
T_15.1 ;
    %jmp T_15;
    .thread T_15;
    .scope S_000001fa49c8d7d0;
T_16 ;
    %wait E_000001fa49c2d000;
    %load/vec4 v000001fa49c9be90_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_16.0, 8;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49c9b990_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9a8b0_0, 0;
    %pushi/vec4 0, 0, 24;
    %assign/vec4 v000001fa49c9a630_0, 0;
    %pushi/vec4 0, 0, 32;
    %assign/vec4 v000001fa49c9b210_0, 0;
    %pushi/vec4 0, 0, 3;
    %assign/vec4 v000001fa49c9a1d0_0, 0;
    %pushi/vec4 0, 0, 64;
    %assign/vec4 v000001fa49c9adb0_0, 0;
    %jmp T_16.1;
T_16.0 ;
    %load/vec4 v000001fa49c9b990_0;
    %dup/vec4;
    %pushi/vec4 0, 0, 4;
    %cmp/u;
    %jmp/1 T_16.2, 6;
    %dup/vec4;
    %pushi/vec4 1, 0, 4;
    %cmp/u;
    %jmp/1 T_16.3, 6;
    %dup/vec4;
    %pushi/vec4 2, 0, 4;
    %cmp/u;
    %jmp/1 T_16.4, 6;
    %dup/vec4;
    %pushi/vec4 3, 0, 4;
    %cmp/u;
    %jmp/1 T_16.5, 6;
    %dup/vec4;
    %pushi/vec4 4, 0, 4;
    %cmp/u;
    %jmp/1 T_16.6, 6;
    %dup/vec4;
    %pushi/vec4 5, 0, 4;
    %cmp/u;
    %jmp/1 T_16.7, 6;
    %jmp T_16.8;
T_16.2 ;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9a8b0_0, 0;
    %load/vec4 v000001fa49c9a9f0_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_16.9, 8;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c9ac70_0, 0, 32;
T_16.11 ;
    %load/vec4 v000001fa49c9ac70_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_16.12, 5;
    %load/vec4 v000001fa49c9bb70_0;
    %load/vec4 v000001fa49c9ac70_0;
    %muli 16, 0, 32;
    %part/s 16;
    %ix/getv/s 3, v000001fa49c9ac70_0;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c9bf30, 0, 4;
    %load/vec4 v000001fa49c9b530_0;
    %load/vec4 v000001fa49c9ac70_0;
    %muli 16, 0, 32;
    %part/s 16;
    %ix/getv/s 3, v000001fa49c9ac70_0;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c9b670, 0, 4;
    %load/vec4 v000001fa49c9b7b0_0;
    %load/vec4 v000001fa49c9ac70_0;
    %muli 16, 0, 32;
    %part/s 16;
    %ix/getv/s 3, v000001fa49c9ac70_0;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c9c070, 0, 4;
    %load/vec4 v000001fa49c9ac70_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c9ac70_0, 0, 32;
    %jmp T_16.11;
T_16.12 ;
    %pushi/vec4 0, 0, 24;
    %assign/vec4 v000001fa49c9a630_0, 0;
    %pushi/vec4 0, 0, 3;
    %assign/vec4 v000001fa49c9a1d0_0, 0;
    %pushi/vec4 1, 0, 4;
    %assign/vec4 v000001fa49c9b990_0, 0;
T_16.9 ;
    %jmp T_16.8;
T_16.3 ;
    %load/vec4 v000001fa49c9a1d0_0;
    %pad/u 32;
    %cmpi/u 4, 0, 32;
    %jmp/0xz  T_16.13, 5;
    %load/vec4 v000001fa49c9a630_0;
    %load/vec4 v000001fa49c9a1d0_0;
    %pad/u 4;
    %ix/vec4 4;
    %load/vec4a v000001fa49c9bf30, 4;
    %parti/s 1, 15, 5;
    %replicate 8;
    %load/vec4 v000001fa49c9a1d0_0;
    %pad/u 4;
    %ix/vec4 4;
    %load/vec4a v000001fa49c9bf30, 4;
    %concat/vec4; draw_concat_vec4
    %add;
    %assign/vec4 v000001fa49c9a630_0, 0;
    %load/vec4 v000001fa49c9a1d0_0;
    %addi 1, 0, 3;
    %assign/vec4 v000001fa49c9a1d0_0, 0;
    %jmp T_16.14;
T_16.13 ;
    %load/vec4 v000001fa49c9a630_0;
    %pad/s 32;
    %pushi/vec4 4, 0, 32;
    %div/s;
    %pad/s 16;
    %assign/vec4 v000001fa49c9ad10_0, 0;
    %pushi/vec4 0, 0, 32;
    %assign/vec4 v000001fa49c9b210_0, 0;
    %pushi/vec4 0, 0, 3;
    %assign/vec4 v000001fa49c9a1d0_0, 0;
    %pushi/vec4 2, 0, 4;
    %assign/vec4 v000001fa49c9b990_0, 0;
T_16.14 ;
    %jmp T_16.8;
T_16.4 ;
    %load/vec4 v000001fa49c9a1d0_0;
    %pad/u 32;
    %cmpi/u 4, 0, 32;
    %jmp/0xz  T_16.15, 5;
    %load/vec4 v000001fa49c9a1d0_0;
    %pad/u 4;
    %ix/vec4 4;
    %load/vec4a v000001fa49c9bf30, 4;
    %load/vec4 v000001fa49c9ad10_0;
    %sub;
    %store/vec4 v000001fa49c9b710_0, 0, 16;
    %load/vec4 v000001fa49c9b210_0;
    %load/vec4 v000001fa49c9b710_0;
    %pad/s 32;
    %load/vec4 v000001fa49c9b710_0;
    %pad/s 32;
    %mul;
    %add;
    %assign/vec4 v000001fa49c9b210_0, 0;
    %load/vec4 v000001fa49c9a1d0_0;
    %addi 1, 0, 3;
    %assign/vec4 v000001fa49c9a1d0_0, 0;
    %jmp T_16.16;
T_16.15 ;
    %load/vec4 v000001fa49c9b210_0;
    %parti/s 16, 8, 5;
    %pad/u 32;
    %pushi/vec4 4, 0, 32;
    %div;
    %pad/u 16;
    %assign/vec4 v000001fa49c9bad0_0, 0;
    %pushi/vec4 3, 0, 4;
    %assign/vec4 v000001fa49c9b990_0, 0;
T_16.16 ;
    %jmp T_16.8;
T_16.5 ;
    %load/vec4 v000001fa49c9bad0_0;
    %store/vec4 v000001fa49c9b850_0, 0, 16;
    %callf/vec4 TD_gpt2_demo_tb.uut.u_block.u_ln2.approx_inv_sqrt, S_000001fa49c8d960;
    %assign/vec4 v000001fa49c9a770_0, 0;
    %pushi/vec4 0, 0, 3;
    %assign/vec4 v000001fa49c9a1d0_0, 0;
    %pushi/vec4 4, 0, 4;
    %assign/vec4 v000001fa49c9b990_0, 0;
    %jmp T_16.8;
T_16.6 ;
    %load/vec4 v000001fa49c9a1d0_0;
    %pad/u 32;
    %cmpi/u 4, 0, 32;
    %jmp/0xz  T_16.17, 5;
    %load/vec4 v000001fa49c9a1d0_0;
    %pad/u 4;
    %ix/vec4 4;
    %load/vec4a v000001fa49c9bf30, 4;
    %load/vec4 v000001fa49c9ad10_0;
    %sub;
    %store/vec4 v000001fa49c9b710_0, 0, 16;
    %load/vec4 v000001fa49c9b710_0;
    %pad/s 32;
    %load/vec4 v000001fa49c9a770_0;
    %pad/s 32;
    %mul;
    %store/vec4 v000001fa49c9ba30_0, 0, 32;
    %load/vec4 v000001fa49c9a1d0_0;
    %pad/u 4;
    %ix/vec4 4;
    %load/vec4a v000001fa49c9b670, 4;
    %pad/u 32;
    %load/vec4 v000001fa49c9ba30_0;
    %parti/s 16, 8, 5;
    %pad/u 32;
    %mul;
    %store/vec4 v000001fa49c9abd0_0, 0, 32;
    %load/vec4 v000001fa49c9abd0_0;
    %parti/s 16, 8, 5;
    %load/vec4 v000001fa49c9a1d0_0;
    %pad/u 4;
    %ix/vec4 4;
    %load/vec4a v000001fa49c9c070, 4;
    %add;
    %ix/load 5, 0, 0;
    %load/vec4 v000001fa49c9a1d0_0;
    %pad/u 32;
    %muli 16, 0, 32;
    %ix/vec4 4;
    %assign/vec4/off/d v000001fa49c9adb0_0, 4, 5;
    %load/vec4 v000001fa49c9a1d0_0;
    %addi 1, 0, 3;
    %assign/vec4 v000001fa49c9a1d0_0, 0;
    %jmp T_16.18;
T_16.17 ;
    %pushi/vec4 5, 0, 4;
    %assign/vec4 v000001fa49c9b990_0, 0;
T_16.18 ;
    %jmp T_16.8;
T_16.7 ;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v000001fa49c9a8b0_0, 0;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49c9b990_0, 0;
    %jmp T_16.8;
T_16.8 ;
    %pop/vec4 1;
T_16.1 ;
    %jmp T_16;
    .thread T_16;
    .scope S_000001fa49c8d640;
T_17 ;
    %wait E_000001fa49c2d000;
    %load/vec4 v000001fa49c8ee20_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_17.0, 8;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49c8eec0_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c8f320_0, 0;
    %pushi/vec4 0, 0, 64;
    %assign/vec4 v000001fa49c8f960_0, 0;
    %jmp T_17.1;
T_17.0 ;
    %load/vec4 v000001fa49c8eec0_0;
    %dup/vec4;
    %pushi/vec4 0, 0, 4;
    %cmp/u;
    %jmp/1 T_17.2, 6;
    %dup/vec4;
    %pushi/vec4 1, 0, 4;
    %cmp/u;
    %jmp/1 T_17.3, 6;
    %dup/vec4;
    %pushi/vec4 2, 0, 4;
    %cmp/u;
    %jmp/1 T_17.4, 6;
    %dup/vec4;
    %pushi/vec4 3, 0, 4;
    %cmp/u;
    %jmp/1 T_17.5, 6;
    %dup/vec4;
    %pushi/vec4 4, 0, 4;
    %cmp/u;
    %jmp/1 T_17.6, 6;
    %jmp T_17.7;
T_17.2 ;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c8f320_0, 0;
    %load/vec4 v000001fa49c90040_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_17.8, 8;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8f780_0, 0, 32;
T_17.10 ;
    %load/vec4 v000001fa49c8f780_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_17.11, 5;
    %load/vec4 v000001fa49c8f8c0_0;
    %load/vec4 v000001fa49c8f780_0;
    %muli 16, 0, 32;
    %part/s 16;
    %ix/getv/s 3, v000001fa49c8f780_0;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c8fdc0, 0, 4;
    %load/vec4 v000001fa49c8f780_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8f780_0, 0, 32;
    %jmp T_17.10;
T_17.11 ;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8f780_0, 0, 32;
T_17.12 ;
    %load/vec4 v000001fa49c8f780_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_17.13, 5;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8f000_0, 0, 32;
T_17.14 ;
    %load/vec4 v000001fa49c8f000_0;
    %cmpi/s 8, 0, 32;
    %jmp/0xz T_17.15, 5;
    %load/vec4 v000001fa49c8e240_0;
    %load/vec4 v000001fa49c8f780_0;
    %muli 8, 0, 32;
    %load/vec4 v000001fa49c8f000_0;
    %add;
    %muli 16, 0, 32;
    %part/s 16;
    %load/vec4 v000001fa49c8f780_0;
    %pad/s 36;
    %pad/s 39;
    %muli 8, 0, 39;
    %pad/s 40;
    %load/vec4 v000001fa49c8f000_0;
    %pad/s 40;
    %add;
    %ix/vec4/s 3;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c8e1a0, 0, 4;
    %load/vec4 v000001fa49c8f000_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8f000_0, 0, 32;
    %jmp T_17.14;
T_17.15 ;
    %load/vec4 v000001fa49c8f780_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8f780_0, 0, 32;
    %jmp T_17.12;
T_17.13 ;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8f000_0, 0, 32;
T_17.16 ;
    %load/vec4 v000001fa49c8f000_0;
    %cmpi/s 8, 0, 32;
    %jmp/0xz T_17.17, 5;
    %load/vec4 v000001fa49c8fa00_0;
    %load/vec4 v000001fa49c8f000_0;
    %muli 16, 0, 32;
    %part/s 16;
    %ix/getv/s 3, v000001fa49c8f000_0;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c8ea60, 0, 4;
    %load/vec4 v000001fa49c8f000_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8f000_0, 0, 32;
    %jmp T_17.16;
T_17.17 ;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8f780_0, 0, 32;
T_17.18 ;
    %load/vec4 v000001fa49c8f780_0;
    %cmpi/s 8, 0, 32;
    %jmp/0xz T_17.19, 5;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8f000_0, 0, 32;
T_17.20 ;
    %load/vec4 v000001fa49c8f000_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_17.21, 5;
    %load/vec4 v000001fa49c8e2e0_0;
    %load/vec4 v000001fa49c8f780_0;
    %muli 4, 0, 32;
    %load/vec4 v000001fa49c8f000_0;
    %add;
    %muli 16, 0, 32;
    %part/s 16;
    %load/vec4 v000001fa49c8f780_0;
    %pad/s 35;
    %pad/s 37;
    %muli 4, 0, 37;
    %pad/s 38;
    %load/vec4 v000001fa49c8f000_0;
    %pad/s 38;
    %add;
    %ix/vec4/s 3;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c8f820, 0, 4;
    %load/vec4 v000001fa49c8f000_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8f000_0, 0, 32;
    %jmp T_17.20;
T_17.21 ;
    %load/vec4 v000001fa49c8f780_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8f780_0, 0, 32;
    %jmp T_17.18;
T_17.19 ;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8f000_0, 0, 32;
T_17.22 ;
    %load/vec4 v000001fa49c8f000_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_17.23, 5;
    %load/vec4 v000001fa49c8faa0_0;
    %load/vec4 v000001fa49c8f000_0;
    %muli 16, 0, 32;
    %part/s 16;
    %ix/getv/s 3, v000001fa49c8f000_0;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c8f3c0, 0, 4;
    %load/vec4 v000001fa49c8f000_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8f000_0, 0, 32;
    %jmp T_17.22;
T_17.23 ;
    %pushi/vec4 1, 0, 4;
    %assign/vec4 v000001fa49c8eec0_0, 0;
T_17.8 ;
    %jmp T_17.7;
T_17.3 ;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8f000_0, 0, 32;
T_17.24 ;
    %load/vec4 v000001fa49c8f000_0;
    %cmpi/s 8, 0, 32;
    %jmp/0xz T_17.25, 5;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8f1e0_0, 0, 32;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8f780_0, 0, 32;
T_17.26 ;
    %load/vec4 v000001fa49c8f780_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_17.27, 5;
    %ix/getv/s 4, v000001fa49c8f780_0;
    %load/vec4a v000001fa49c8fdc0, 4;
    %pad/s 32;
    %load/vec4 v000001fa49c8f780_0;
    %pad/s 36;
    %pad/s 39;
    %muli 8, 0, 39;
    %pad/s 40;
    %load/vec4 v000001fa49c8f000_0;
    %pad/s 40;
    %add;
    %ix/vec4/s 4;
    %load/vec4a v000001fa49c8e1a0, 4;
    %pad/s 32;
    %mul;
    %store/vec4 v000001fa49c8fb40_0, 0, 32;
    %load/vec4 v000001fa49c8f1e0_0;
    %load/vec4 v000001fa49c8fb40_0;
    %add;
    %store/vec4 v000001fa49c8f1e0_0, 0, 32;
    %load/vec4 v000001fa49c8f780_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8f780_0, 0, 32;
    %jmp T_17.26;
T_17.27 ;
    %load/vec4 v000001fa49c8f1e0_0;
    %parti/s 16, 8, 5;
    %ix/getv/s 4, v000001fa49c8f000_0;
    %load/vec4a v000001fa49c8ea60, 4;
    %add;
    %ix/getv/s 4, v000001fa49c8f000_0;
    %store/vec4a v000001fa49c8f6e0, 4, 0;
    %load/vec4 v000001fa49c8f000_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8f000_0, 0, 32;
    %jmp T_17.24;
T_17.25 ;
    %pushi/vec4 2, 0, 4;
    %assign/vec4 v000001fa49c8eec0_0, 0;
    %jmp T_17.7;
T_17.4 ;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8f000_0, 0, 32;
T_17.28 ;
    %load/vec4 v000001fa49c8f000_0;
    %cmpi/s 8, 0, 32;
    %jmp/0xz T_17.29, 5;
    %ix/getv/s 4, v000001fa49c8f000_0;
    %load/vec4a v000001fa49c8f6e0, 4;
    %cmpi/s 64768, 0, 16;
    %jmp/0xz  T_17.30, 5;
    %pushi/vec4 0, 0, 16;
    %ix/getv/s 4, v000001fa49c8f000_0;
    %store/vec4a v000001fa49c8f280, 4, 0;
    %jmp T_17.31;
T_17.30 ;
    %ix/getv/s 4, v000001fa49c8f000_0;
    %load/vec4a v000001fa49c8f6e0, 4;
    %cmpi/s 768, 0, 16;
    %flag_or 5, 4; GT is !LE
    %flag_inv 5;
    %jmp/0xz  T_17.32, 5;
    %ix/getv/s 4, v000001fa49c8f000_0;
    %load/vec4a v000001fa49c8f6e0, 4;
    %ix/getv/s 4, v000001fa49c8f000_0;
    %store/vec4a v000001fa49c8f280, 4, 0;
    %jmp T_17.33;
T_17.32 ;
    %ix/getv/s 4, v000001fa49c8f000_0;
    %load/vec4a v000001fa49c8f6e0, 4;
    %pad/s 32;
    %muli 43, 0, 32;
    %store/vec4 v000001fa49c8ffa0_0, 0, 32;
    %pushi/vec4 128, 0, 16;
    %load/vec4 v000001fa49c8ffa0_0;
    %parti/s 16, 8, 5;
    %add;
    %store/vec4 v000001fa49c8fc80_0, 0, 16;
    %ix/getv/s 4, v000001fa49c8f000_0;
    %load/vec4a v000001fa49c8f6e0, 4;
    %pad/s 32;
    %load/vec4 v000001fa49c8fc80_0;
    %pad/s 32;
    %mul;
    %store/vec4 v000001fa49c8ec40_0, 0, 32;
    %load/vec4 v000001fa49c8ec40_0;
    %parti/s 16, 8, 5;
    %ix/getv/s 4, v000001fa49c8f000_0;
    %store/vec4a v000001fa49c8f280, 4, 0;
T_17.33 ;
T_17.31 ;
    %load/vec4 v000001fa49c8f000_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8f000_0, 0, 32;
    %jmp T_17.28;
T_17.29 ;
    %pushi/vec4 3, 0, 4;
    %assign/vec4 v000001fa49c8eec0_0, 0;
    %jmp T_17.7;
T_17.5 ;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8f000_0, 0, 32;
T_17.34 ;
    %load/vec4 v000001fa49c8f000_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_17.35, 5;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8f1e0_0, 0, 32;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c8f780_0, 0, 32;
T_17.36 ;
    %load/vec4 v000001fa49c8f780_0;
    %cmpi/s 8, 0, 32;
    %jmp/0xz T_17.37, 5;
    %ix/getv/s 4, v000001fa49c8f780_0;
    %load/vec4a v000001fa49c8f280, 4;
    %pad/s 32;
    %load/vec4 v000001fa49c8f780_0;
    %pad/s 35;
    %pad/s 37;
    %muli 4, 0, 37;
    %pad/s 38;
    %load/vec4 v000001fa49c8f000_0;
    %pad/s 38;
    %add;
    %ix/vec4/s 4;
    %load/vec4a v000001fa49c8f820, 4;
    %pad/s 32;
    %mul;
    %store/vec4 v000001fa49c8fb40_0, 0, 32;
    %load/vec4 v000001fa49c8f1e0_0;
    %load/vec4 v000001fa49c8fb40_0;
    %add;
    %store/vec4 v000001fa49c8f1e0_0, 0, 32;
    %load/vec4 v000001fa49c8f780_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8f780_0, 0, 32;
    %jmp T_17.36;
T_17.37 ;
    %load/vec4 v000001fa49c8f1e0_0;
    %parti/s 16, 8, 5;
    %ix/getv/s 4, v000001fa49c8f000_0;
    %load/vec4a v000001fa49c8f3c0, 4;
    %add;
    %ix/load 5, 0, 0;
    %load/vec4 v000001fa49c8f000_0;
    %muli 16, 0, 32;
    %ix/vec4/s 4;
    %assign/vec4/off/d v000001fa49c8f960_0, 4, 5;
    %load/vec4 v000001fa49c8f000_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c8f000_0, 0, 32;
    %jmp T_17.34;
T_17.35 ;
    %pushi/vec4 4, 0, 4;
    %assign/vec4 v000001fa49c8eec0_0, 0;
    %jmp T_17.7;
T_17.6 ;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v000001fa49c8f320_0, 0;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49c8eec0_0, 0;
    %jmp T_17.7;
T_17.7 ;
    %pop/vec4 1;
T_17.1 ;
    %jmp T_17;
    .thread T_17;
    .scope S_000001fa49c19a20;
T_18 ;
    %wait E_000001fa49c2d000;
    %load/vec4 v000001fa49c9b5d0_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_18.0, 8;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49c9d2c0_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9c460_0, 0;
    %pushi/vec4 0, 0, 64;
    %assign/vec4 v000001fa49c9cbe0_0, 0;
    %pushi/vec4 0, 0, 64;
    %assign/vec4 v000001fa49c9b350_0, 0;
    %pushi/vec4 0, 0, 64;
    %assign/vec4 v000001fa49c9b3f0_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9a4f0_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9a270_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9ab30_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9bcb0_0, 0;
    %jmp T_18.1;
T_18.0 ;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9a4f0_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9a270_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9ab30_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9bcb0_0, 0;
    %load/vec4 v000001fa49c9d2c0_0;
    %dup/vec4;
    %pushi/vec4 0, 0, 4;
    %cmp/u;
    %jmp/1 T_18.2, 6;
    %dup/vec4;
    %pushi/vec4 1, 0, 4;
    %cmp/u;
    %jmp/1 T_18.3, 6;
    %dup/vec4;
    %pushi/vec4 2, 0, 4;
    %cmp/u;
    %jmp/1 T_18.4, 6;
    %dup/vec4;
    %pushi/vec4 3, 0, 4;
    %cmp/u;
    %jmp/1 T_18.5, 6;
    %dup/vec4;
    %pushi/vec4 4, 0, 4;
    %cmp/u;
    %jmp/1 T_18.6, 6;
    %dup/vec4;
    %pushi/vec4 5, 0, 4;
    %cmp/u;
    %jmp/1 T_18.7, 6;
    %dup/vec4;
    %pushi/vec4 7, 0, 4;
    %cmp/u;
    %jmp/1 T_18.8, 6;
    %jmp T_18.9;
T_18.2 ;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9c460_0, 0;
    %load/vec4 v000001fa49c9c960_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_18.10, 8;
    %load/vec4 v000001fa49c9d720_0;
    %assign/vec4 v000001fa49c9b350_0, 0;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v000001fa49c9a4f0_0, 0;
    %pushi/vec4 1, 0, 4;
    %assign/vec4 v000001fa49c9d2c0_0, 0;
T_18.10 ;
    %jmp T_18.9;
T_18.3 ;
    %load/vec4 v000001fa49c9a810_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_18.12, 8;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v000001fa49c9a270_0, 0;
    %pushi/vec4 2, 0, 4;
    %assign/vec4 v000001fa49c9d2c0_0, 0;
T_18.12 ;
    %jmp T_18.9;
T_18.4 ;
    %load/vec4 v000001fa49c9b490_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_18.14, 8;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c9af90_0, 0, 32;
T_18.16 ;
    %load/vec4 v000001fa49c9af90_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_18.17, 5;
    %load/vec4 v000001fa49c9b350_0;
    %load/vec4 v000001fa49c9af90_0;
    %muli 16, 0, 32;
    %part/s 16;
    %load/vec4 v000001fa49c9a310_0;
    %load/vec4 v000001fa49c9af90_0;
    %muli 16, 0, 32;
    %part/s 16;
    %add;
    %ix/load 5, 0, 0;
    %load/vec4 v000001fa49c9af90_0;
    %muli 16, 0, 32;
    %ix/vec4/s 4;
    %assign/vec4/off/d v000001fa49c9b3f0_0, 4, 5;
    %load/vec4 v000001fa49c9af90_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c9af90_0, 0, 32;
    %jmp T_18.16;
T_18.17 ;
    %pushi/vec4 3, 0, 4;
    %assign/vec4 v000001fa49c9d2c0_0, 0;
T_18.14 ;
    %jmp T_18.9;
T_18.5 ;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v000001fa49c9ab30_0, 0;
    %pushi/vec4 4, 0, 4;
    %assign/vec4 v000001fa49c9d2c0_0, 0;
    %jmp T_18.9;
T_18.6 ;
    %load/vec4 v000001fa49c9b2b0_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_18.18, 8;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v000001fa49c9bcb0_0, 0;
    %pushi/vec4 5, 0, 4;
    %assign/vec4 v000001fa49c9d2c0_0, 0;
T_18.18 ;
    %jmp T_18.9;
T_18.7 ;
    %load/vec4 v000001fa49c9b0d0_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_18.20, 8;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c9af90_0, 0, 32;
T_18.22 ;
    %load/vec4 v000001fa49c9af90_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_18.23, 5;
    %load/vec4 v000001fa49c9b3f0_0;
    %load/vec4 v000001fa49c9af90_0;
    %muli 16, 0, 32;
    %part/s 16;
    %load/vec4 v000001fa49c9a3b0_0;
    %load/vec4 v000001fa49c9af90_0;
    %muli 16, 0, 32;
    %part/s 16;
    %add;
    %ix/load 5, 0, 0;
    %load/vec4 v000001fa49c9af90_0;
    %muli 16, 0, 32;
    %ix/vec4/s 4;
    %assign/vec4/off/d v000001fa49c9cbe0_0, 4, 5;
    %load/vec4 v000001fa49c9af90_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c9af90_0, 0, 32;
    %jmp T_18.22;
T_18.23 ;
    %pushi/vec4 7, 0, 4;
    %assign/vec4 v000001fa49c9d2c0_0, 0;
T_18.20 ;
    %jmp T_18.9;
T_18.8 ;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v000001fa49c9c460_0, 0;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49c9d2c0_0, 0;
    %jmp T_18.9;
T_18.9 ;
    %pop/vec4 1;
T_18.1 ;
    %jmp T_18;
    .thread T_18;
    .scope S_000001fa49c8dc80;
T_19 ;
    %wait E_000001fa49c2d000;
    %load/vec4 v000001fa49c9d180_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_19.0, 8;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49c9dd60_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9c320_0, 0;
    %pushi/vec4 0, 0, 24;
    %assign/vec4 v000001fa49c9caa0_0, 0;
    %pushi/vec4 0, 0, 32;
    %assign/vec4 v000001fa49c9c500_0, 0;
    %pushi/vec4 0, 0, 3;
    %assign/vec4 v000001fa49c9d4a0_0, 0;
    %pushi/vec4 0, 0, 64;
    %assign/vec4 v000001fa49c8d020_0, 0;
    %jmp T_19.1;
T_19.0 ;
    %load/vec4 v000001fa49c9dd60_0;
    %dup/vec4;
    %pushi/vec4 0, 0, 4;
    %cmp/u;
    %jmp/1 T_19.2, 6;
    %dup/vec4;
    %pushi/vec4 1, 0, 4;
    %cmp/u;
    %jmp/1 T_19.3, 6;
    %dup/vec4;
    %pushi/vec4 2, 0, 4;
    %cmp/u;
    %jmp/1 T_19.4, 6;
    %dup/vec4;
    %pushi/vec4 3, 0, 4;
    %cmp/u;
    %jmp/1 T_19.5, 6;
    %dup/vec4;
    %pushi/vec4 4, 0, 4;
    %cmp/u;
    %jmp/1 T_19.6, 6;
    %dup/vec4;
    %pushi/vec4 5, 0, 4;
    %cmp/u;
    %jmp/1 T_19.7, 6;
    %jmp T_19.8;
T_19.2 ;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9c320_0, 0;
    %load/vec4 v000001fa49c9de00_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_19.9, 8;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49c9c3c0_0, 0, 32;
T_19.11 ;
    %load/vec4 v000001fa49c9c3c0_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_19.12, 5;
    %load/vec4 v000001fa49c9cb40_0;
    %load/vec4 v000001fa49c9c3c0_0;
    %muli 16, 0, 32;
    %part/s 16;
    %ix/getv/s 3, v000001fa49c9c3c0_0;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c9c820, 0, 4;
    %load/vec4 v000001fa49c9e080_0;
    %load/vec4 v000001fa49c9c3c0_0;
    %muli 16, 0, 32;
    %part/s 16;
    %ix/getv/s 3, v000001fa49c9c3c0_0;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c9dc20, 0, 4;
    %load/vec4 v000001fa49c9dae0_0;
    %load/vec4 v000001fa49c9c3c0_0;
    %muli 16, 0, 32;
    %part/s 16;
    %ix/getv/s 3, v000001fa49c9c3c0_0;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49c9dfe0, 0, 4;
    %load/vec4 v000001fa49c9c3c0_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c9c3c0_0, 0, 32;
    %jmp T_19.11;
T_19.12 ;
    %pushi/vec4 0, 0, 24;
    %assign/vec4 v000001fa49c9caa0_0, 0;
    %pushi/vec4 0, 0, 3;
    %assign/vec4 v000001fa49c9d4a0_0, 0;
    %pushi/vec4 1, 0, 4;
    %assign/vec4 v000001fa49c9dd60_0, 0;
T_19.9 ;
    %jmp T_19.8;
T_19.3 ;
    %load/vec4 v000001fa49c9d4a0_0;
    %pad/u 32;
    %cmpi/u 4, 0, 32;
    %jmp/0xz  T_19.13, 5;
    %load/vec4 v000001fa49c9caa0_0;
    %load/vec4 v000001fa49c9d4a0_0;
    %pad/u 4;
    %ix/vec4 4;
    %load/vec4a v000001fa49c9c820, 4;
    %parti/s 1, 15, 5;
    %replicate 8;
    %load/vec4 v000001fa49c9d4a0_0;
    %pad/u 4;
    %ix/vec4 4;
    %load/vec4a v000001fa49c9c820, 4;
    %concat/vec4; draw_concat_vec4
    %add;
    %assign/vec4 v000001fa49c9caa0_0, 0;
    %load/vec4 v000001fa49c9d4a0_0;
    %addi 1, 0, 3;
    %assign/vec4 v000001fa49c9d4a0_0, 0;
    %jmp T_19.14;
T_19.13 ;
    %load/vec4 v000001fa49c9caa0_0;
    %pad/s 32;
    %pushi/vec4 4, 0, 32;
    %div/s;
    %pad/s 16;
    %assign/vec4 v000001fa49c9d0e0_0, 0;
    %pushi/vec4 0, 0, 32;
    %assign/vec4 v000001fa49c9c500_0, 0;
    %pushi/vec4 0, 0, 3;
    %assign/vec4 v000001fa49c9d4a0_0, 0;
    %pushi/vec4 2, 0, 4;
    %assign/vec4 v000001fa49c9dd60_0, 0;
T_19.14 ;
    %jmp T_19.8;
T_19.4 ;
    %load/vec4 v000001fa49c9d4a0_0;
    %pad/u 32;
    %cmpi/u 4, 0, 32;
    %jmp/0xz  T_19.15, 5;
    %load/vec4 v000001fa49c9d4a0_0;
    %pad/u 4;
    %ix/vec4 4;
    %load/vec4a v000001fa49c9c820, 4;
    %load/vec4 v000001fa49c9d0e0_0;
    %sub;
    %store/vec4 v000001fa49c9cf00_0, 0, 16;
    %load/vec4 v000001fa49c9c500_0;
    %load/vec4 v000001fa49c9cf00_0;
    %pad/s 32;
    %load/vec4 v000001fa49c9cf00_0;
    %pad/s 32;
    %mul;
    %add;
    %assign/vec4 v000001fa49c9c500_0, 0;
    %load/vec4 v000001fa49c9d4a0_0;
    %addi 1, 0, 3;
    %assign/vec4 v000001fa49c9d4a0_0, 0;
    %jmp T_19.16;
T_19.15 ;
    %load/vec4 v000001fa49c9c500_0;
    %parti/s 16, 8, 5;
    %pad/u 32;
    %pushi/vec4 4, 0, 32;
    %div;
    %pad/u 16;
    %assign/vec4 v000001fa49c9c640_0, 0;
    %pushi/vec4 3, 0, 4;
    %assign/vec4 v000001fa49c9dd60_0, 0;
T_19.16 ;
    %jmp T_19.8;
T_19.5 ;
    %load/vec4 v000001fa49c9c640_0;
    %store/vec4 v000001fa49c9d400_0, 0, 16;
    %callf/vec4 TD_gpt2_demo_tb.uut.u_ln_final.approx_inv_sqrt, S_000001fa49c8dfa0;
    %assign/vec4 v000001fa49c9c280_0, 0;
    %pushi/vec4 0, 0, 3;
    %assign/vec4 v000001fa49c9d4a0_0, 0;
    %pushi/vec4 4, 0, 4;
    %assign/vec4 v000001fa49c9dd60_0, 0;
    %jmp T_19.8;
T_19.6 ;
    %load/vec4 v000001fa49c9d4a0_0;
    %pad/u 32;
    %cmpi/u 4, 0, 32;
    %jmp/0xz  T_19.17, 5;
    %load/vec4 v000001fa49c9d4a0_0;
    %pad/u 4;
    %ix/vec4 4;
    %load/vec4a v000001fa49c9c820, 4;
    %load/vec4 v000001fa49c9d0e0_0;
    %sub;
    %store/vec4 v000001fa49c9cf00_0, 0, 16;
    %load/vec4 v000001fa49c9cf00_0;
    %pad/s 32;
    %load/vec4 v000001fa49c9c280_0;
    %pad/s 32;
    %mul;
    %store/vec4 v000001fa49c9dea0_0, 0, 32;
    %load/vec4 v000001fa49c9d4a0_0;
    %pad/u 4;
    %ix/vec4 4;
    %load/vec4a v000001fa49c9dc20, 4;
    %pad/u 32;
    %load/vec4 v000001fa49c9dea0_0;
    %parti/s 16, 8, 5;
    %pad/u 32;
    %mul;
    %store/vec4 v000001fa49c9df40_0, 0, 32;
    %load/vec4 v000001fa49c9df40_0;
    %parti/s 16, 8, 5;
    %load/vec4 v000001fa49c9d4a0_0;
    %pad/u 4;
    %ix/vec4 4;
    %load/vec4a v000001fa49c9dfe0, 4;
    %add;
    %ix/load 5, 0, 0;
    %load/vec4 v000001fa49c9d4a0_0;
    %pad/u 32;
    %muli 16, 0, 32;
    %ix/vec4 4;
    %assign/vec4/off/d v000001fa49c8d020_0, 4, 5;
    %load/vec4 v000001fa49c9d4a0_0;
    %addi 1, 0, 3;
    %assign/vec4 v000001fa49c9d4a0_0, 0;
    %jmp T_19.18;
T_19.17 ;
    %pushi/vec4 5, 0, 4;
    %assign/vec4 v000001fa49c9dd60_0, 0;
T_19.18 ;
    %jmp T_19.8;
T_19.7 ;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v000001fa49c9c320_0, 0;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49c9dd60_0, 0;
    %jmp T_19.8;
T_19.8 ;
    %pop/vec4 1;
T_19.1 ;
    %jmp T_19;
    .thread T_19;
    .scope S_000001fa49a66960;
T_20 ;
    %wait E_000001fa49c2d000;
    %load/vec4 v000001fa49c9e790_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_20.0, 8;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49c9f050_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9fd70_0, 0;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49c9fa50_0, 0;
    %pushi/vec4 0, 0, 64;
    %assign/vec4 v000001fa49c9efb0_0, 0;
    %pushi/vec4 0, 0, 2;
    %assign/vec4 v000001fa49c9f5f0_0, 0;
    %pushi/vec4 0, 0, 64;
    %assign/vec4 v000001fa49c9f0f0_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9f370_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9f730_0, 0;
    %jmp T_20.1;
T_20.0 ;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9f370_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9f730_0, 0;
    %load/vec4 v000001fa49c9f050_0;
    %dup/vec4;
    %pushi/vec4 0, 0, 4;
    %cmp/u;
    %jmp/1 T_20.2, 6;
    %dup/vec4;
    %pushi/vec4 1, 0, 4;
    %cmp/u;
    %jmp/1 T_20.3, 6;
    %dup/vec4;
    %pushi/vec4 2, 0, 4;
    %cmp/u;
    %jmp/1 T_20.4, 6;
    %dup/vec4;
    %pushi/vec4 3, 0, 4;
    %cmp/u;
    %jmp/1 T_20.5, 6;
    %dup/vec4;
    %pushi/vec4 4, 0, 4;
    %cmp/u;
    %jmp/1 T_20.6, 6;
    %dup/vec4;
    %pushi/vec4 5, 0, 4;
    %cmp/u;
    %jmp/1 T_20.7, 6;
    %jmp T_20.8;
T_20.2 ;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49c9fd70_0, 0;
    %load/vec4 v000001fa49c9fcd0_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_20.9, 8;
    %pushi/vec4 1, 0, 4;
    %assign/vec4 v000001fa49c9f050_0, 0;
T_20.9 ;
    %jmp T_20.8;
T_20.3 ;
    %load/vec4 v000001fa49c9f4b0_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_20.11, 8;
    %load/vec4 v000001fa49c9f410_0;
    %assign/vec4 v000001fa49c9f0f0_0, 0;
    %pushi/vec4 0, 0, 2;
    %assign/vec4 v000001fa49c9f5f0_0, 0;
    %pushi/vec4 2, 0, 4;
    %assign/vec4 v000001fa49c9f050_0, 0;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v000001fa49c9f370_0, 0;
T_20.11 ;
    %jmp T_20.8;
T_20.4 ;
    %load/vec4 v000001fa49c9e5b0_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_20.13, 8;
    %load/vec4 v000001fa49c9eab0_0;
    %assign/vec4 v000001fa49c9f0f0_0, 0;
    %load/vec4 v000001fa49c9f5f0_0;
    %addi 1, 0, 2;
    %assign/vec4 v000001fa49c9f5f0_0, 0;
    %load/vec4 v000001fa49c9f5f0_0;
    %pad/u 32;
    %addi 1, 0, 32;
    %cmpi/u 2, 0, 32;
    %jmp/0xz  T_20.15, 5;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v000001fa49c9f370_0, 0;
    %jmp T_20.16;
T_20.15 ;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v000001fa49c9f730_0, 0;
    %pushi/vec4 3, 0, 4;
    %assign/vec4 v000001fa49c9f050_0, 0;
T_20.16 ;
T_20.13 ;
    %jmp T_20.8;
T_20.5 ;
    %load/vec4 v000001fa49c9e330_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_20.17, 8;
    %load/vec4 v000001fa49ca0090_0;
    %assign/vec4 v000001fa49c9efb0_0, 0;
    %pushi/vec4 4, 0, 4;
    %assign/vec4 v000001fa49c9f050_0, 0;
T_20.17 ;
    %jmp T_20.8;
T_20.6 ;
    %fork t_1, S_000001fa49c19890;
    %jmp t_0;
    .scope S_000001fa49c19890;
t_1 ;
    %load/vec4 v000001fa49c9efb0_0;
    %parti/s 16, 0, 2;
    %store/vec4 v000001fa49c8c940_0, 0, 16;
    %pushi/vec4 0, 0, 4;
    %store/vec4 v000001fa49c8b2c0_0, 0, 4;
    %pushi/vec4 1, 0, 32;
    %store/vec4 v000001fa49c9faf0_0, 0, 32;
T_20.19 ;
    %load/vec4 v000001fa49c9faf0_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_20.20, 5;
    %load/vec4 v000001fa49c8c940_0;
    %load/vec4 v000001fa49c9efb0_0;
    %load/vec4 v000001fa49c9faf0_0;
    %muli 16, 0, 32;
    %part/s 16;
    %cmp/s;
    %jmp/0xz  T_20.21, 5;
    %load/vec4 v000001fa49c9efb0_0;
    %load/vec4 v000001fa49c9faf0_0;
    %muli 16, 0, 32;
    %part/s 16;
    %store/vec4 v000001fa49c8c940_0, 0, 16;
    %load/vec4 v000001fa49c9faf0_0;
    %pad/s 4;
    %store/vec4 v000001fa49c8b2c0_0, 0, 4;
T_20.21 ;
    %load/vec4 v000001fa49c9faf0_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49c9faf0_0, 0, 32;
    %jmp T_20.19;
T_20.20 ;
    %load/vec4 v000001fa49c8b2c0_0;
    %assign/vec4 v000001fa49c9fa50_0, 0;
    %end;
    .scope S_000001fa49a66960;
t_0 %join;
    %pushi/vec4 5, 0, 4;
    %assign/vec4 v000001fa49c9f050_0, 0;
    %jmp T_20.8;
T_20.7 ;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v000001fa49c9fd70_0, 0;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49c9f050_0, 0;
    %jmp T_20.8;
T_20.8 ;
    %pop/vec4 1;
T_20.1 ;
    %jmp T_20;
    .thread T_20;
    .scope S_000001fa49c1b900;
T_21 ;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v000001fa49c9fb90_0, 0, 1;
    %end;
    .thread T_21;
    .scope S_000001fa49c1b900;
T_22 ;
    %delay 5000, 0;
    %load/vec4 v000001fa49c9fb90_0;
    %inv;
    %store/vec4 v000001fa49c9fb90_0, 0, 1;
    %jmp T_22;
    .thread T_22;
    .scope S_000001fa49c1b900;
T_23 ;
    %vpi_call 3 209 "$dumpfile", "sim/waveforms/gpt2_demo.vcd" {0 0 0};
    %vpi_call 3 210 "$dumpvars", 32'sb00000000000000000000000000000000, S_000001fa49c1b900 {0 0 0};
    %end;
    .thread T_23;
    .scope S_000001fa49c1b900;
T_24 ;
    %pushi/vec4 1, 0, 1;
    %store/vec4 v000001fa49ca1380_0, 0, 1;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v000001fa49ca0200_0, 0, 1;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v000001fa49ca1d80_0, 0, 1;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v000001fa49ca1060_0, 0, 1;
    %pushi/vec4 0, 0, 4;
    %store/vec4 v000001fa49ca1740_0, 0, 4;
    %pushi/vec4 0, 0, 2;
    %store/vec4 v000001fa49ca11a0_0, 0, 2;
    %pushi/vec4 0, 0, 16;
    %store/vec4 v000001fa49ca1ec0_0, 0, 16;
    %pushi/vec4 0, 0, 3;
    %store/vec4 v000001fa49ca2000_0, 0, 3;
    %pushi/vec4 0, 0, 4;
    %store/vec4 v000001fa49ca1e20_0, 0, 4;
    %pushi/vec4 0, 0, 3;
    %store/vec4 v000001fa49ca1100_0, 0, 3;
    %pushi/vec4 2147516416, 0, 39;
    %concati/vec4 16777472, 0, 25;
    %store/vec4 v000001fa49c9f230_0, 0, 64;
    %pushi/vec4 0, 0, 64;
    %store/vec4 v000001fa49c9f190_0, 0, 64;
    %pushi/vec4 2147516416, 0, 39;
    %concati/vec4 16777472, 0, 25;
    %store/vec4 v000001fa49ca1600_0, 0, 64;
    %pushi/vec4 0, 0, 64;
    %store/vec4 v000001fa49ca19c0_0, 0, 64;
    %pushi/vec4 2147516416, 0, 39;
    %concati/vec4 16777472, 0, 25;
    %store/vec4 v000001fa49ca1920_0, 0, 64;
    %pushi/vec4 0, 0, 64;
    %store/vec4 v000001fa49ca1ce0_0, 0, 64;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v000001fa49c8b9a0_0, 0, 1;
    %callf/vec4 TD_gpt2_demo_tb.make_identity, S_000001fa49b78220;
    %store/vec4 v000001fa49ca12e0_0, 0, 256;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v000001fa49c8b9a0_0, 0, 1;
    %callf/vec4 TD_gpt2_demo_tb.make_identity, S_000001fa49b78220;
    %store/vec4 v000001fa49ca1240_0, 0, 256;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v000001fa49c8b9a0_0, 0, 1;
    %callf/vec4 TD_gpt2_demo_tb.make_identity, S_000001fa49b78220;
    %store/vec4 v000001fa49ca16a0_0, 0, 256;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v000001fa49c8b9a0_0, 0, 1;
    %callf/vec4 TD_gpt2_demo_tb.make_identity, S_000001fa49b78220;
    %store/vec4 v000001fa49ca07a0_0, 0, 256;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v000001fa49c8cbc0_0, 0, 1;
    %callf/vec4 TD_gpt2_demo_tb.make_ffn_w1, S_000001fa49ad8110;
    %store/vec4 v000001fa49c9e970_0, 0, 512;
    %pushi/vec4 0, 0, 128;
    %store/vec4 v000001fa49c9e510_0, 0, 128;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v000001fa49c8b400_0, 0, 1;
    %callf/vec4 TD_gpt2_demo_tb.make_ffn_w2, S_000001fa49b78090;
    %store/vec4 v000001fa49c9ea10_0, 0, 512;
    %pushi/vec4 0, 0, 64;
    %store/vec4 v000001fa49c9e8d0_0, 0, 64;
    %delay 35000, 0;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v000001fa49ca1380_0, 0, 1;
    %delay 25000, 0;
    %pushi/vec4 0, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 0, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 256, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 0, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 1, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 128, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 0, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 2, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 128, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 0, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 3, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 128, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 1, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 0, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 128, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 1, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 1, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 512, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 1, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 2, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 256, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 1, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 3, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 128, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 2, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 0, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 256, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 2, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 1, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 256, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 2, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 2, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 768, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 2, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 3, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 256, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 3, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 0, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 512, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 3, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 1, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 768, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 3, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 2, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 1024, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 3, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 3, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 1280, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 4, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 0, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 1024, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 4, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 1, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 1280, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 4, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 2, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 1536, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 4, 0, 4;
    %store/vec4 v000001fa49c8c9e0_0, 0, 4;
    %pushi/vec4 3, 0, 2;
    %store/vec4 v000001fa49c8c6c0_0, 0, 2;
    %pushi/vec4 1792, 0, 16;
    %store/vec4 v000001fa49c8cee0_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_tok, S_000001fa49ad7f80;
    %join;
    %pushi/vec4 0, 0, 3;
    %store/vec4 v000001fa49c8c580_0, 0, 3;
    %pushi/vec4 0, 0, 2;
    %store/vec4 v000001fa49c8b680_0, 0, 2;
    %pushi/vec4 13, 0, 16;
    %store/vec4 v000001fa49c8cb20_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_pos, S_000001fa49b3baf0;
    %join;
    %pushi/vec4 0, 0, 3;
    %store/vec4 v000001fa49c8c580_0, 0, 3;
    %pushi/vec4 1, 0, 2;
    %store/vec4 v000001fa49c8b680_0, 0, 2;
    %pushi/vec4 13, 0, 16;
    %store/vec4 v000001fa49c8cb20_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_pos, S_000001fa49b3baf0;
    %join;
    %pushi/vec4 0, 0, 3;
    %store/vec4 v000001fa49c8c580_0, 0, 3;
    %pushi/vec4 2, 0, 2;
    %store/vec4 v000001fa49c8b680_0, 0, 2;
    %pushi/vec4 13, 0, 16;
    %store/vec4 v000001fa49c8cb20_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_pos, S_000001fa49b3baf0;
    %join;
    %pushi/vec4 0, 0, 3;
    %store/vec4 v000001fa49c8c580_0, 0, 3;
    %pushi/vec4 3, 0, 2;
    %store/vec4 v000001fa49c8b680_0, 0, 2;
    %pushi/vec4 13, 0, 16;
    %store/vec4 v000001fa49c8cb20_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_pos, S_000001fa49b3baf0;
    %join;
    %pushi/vec4 1, 0, 3;
    %store/vec4 v000001fa49c8c580_0, 0, 3;
    %pushi/vec4 0, 0, 2;
    %store/vec4 v000001fa49c8b680_0, 0, 2;
    %pushi/vec4 26, 0, 16;
    %store/vec4 v000001fa49c8cb20_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_pos, S_000001fa49b3baf0;
    %join;
    %pushi/vec4 1, 0, 3;
    %store/vec4 v000001fa49c8c580_0, 0, 3;
    %pushi/vec4 1, 0, 2;
    %store/vec4 v000001fa49c8b680_0, 0, 2;
    %pushi/vec4 26, 0, 16;
    %store/vec4 v000001fa49c8cb20_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_pos, S_000001fa49b3baf0;
    %join;
    %pushi/vec4 1, 0, 3;
    %store/vec4 v000001fa49c8c580_0, 0, 3;
    %pushi/vec4 2, 0, 2;
    %store/vec4 v000001fa49c8b680_0, 0, 2;
    %pushi/vec4 26, 0, 16;
    %store/vec4 v000001fa49c8cb20_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_pos, S_000001fa49b3baf0;
    %join;
    %pushi/vec4 1, 0, 3;
    %store/vec4 v000001fa49c8c580_0, 0, 3;
    %pushi/vec4 3, 0, 2;
    %store/vec4 v000001fa49c8b680_0, 0, 2;
    %pushi/vec4 26, 0, 16;
    %store/vec4 v000001fa49c8cb20_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_pos, S_000001fa49b3baf0;
    %join;
    %pushi/vec4 2, 0, 3;
    %store/vec4 v000001fa49c8c580_0, 0, 3;
    %pushi/vec4 0, 0, 2;
    %store/vec4 v000001fa49c8b680_0, 0, 2;
    %pushi/vec4 38, 0, 16;
    %store/vec4 v000001fa49c8cb20_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_pos, S_000001fa49b3baf0;
    %join;
    %pushi/vec4 2, 0, 3;
    %store/vec4 v000001fa49c8c580_0, 0, 3;
    %pushi/vec4 1, 0, 2;
    %store/vec4 v000001fa49c8b680_0, 0, 2;
    %pushi/vec4 38, 0, 16;
    %store/vec4 v000001fa49c8cb20_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_pos, S_000001fa49b3baf0;
    %join;
    %pushi/vec4 2, 0, 3;
    %store/vec4 v000001fa49c8c580_0, 0, 3;
    %pushi/vec4 2, 0, 2;
    %store/vec4 v000001fa49c8b680_0, 0, 2;
    %pushi/vec4 38, 0, 16;
    %store/vec4 v000001fa49c8cb20_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_pos, S_000001fa49b3baf0;
    %join;
    %pushi/vec4 2, 0, 3;
    %store/vec4 v000001fa49c8c580_0, 0, 3;
    %pushi/vec4 3, 0, 2;
    %store/vec4 v000001fa49c8b680_0, 0, 2;
    %pushi/vec4 38, 0, 16;
    %store/vec4 v000001fa49c8cb20_0, 0, 16;
    %fork TD_gpt2_demo_tb.load_pos, S_000001fa49b3baf0;
    %join;
    %delay 20000, 0;
    %fork TD_gpt2_demo_tb.print_header, S_000001fa49b25860;
    %join;
    %vpi_call 3 274 "$display", "================== INFERENCE RUN 1 ==================" {0 0 0};
    %pushi/vec4 3, 0, 4;
    %store/vec4 v000001fa49c8c760_0, 0, 4;
    %pushi/vec4 0, 0, 3;
    %store/vec4 v000001fa49c8b860_0, 0, 3;
    %fork TD_gpt2_demo_tb.run_inference, S_000001fa49b259f0;
    %join;
    %delay 100000, 0;
    %vpi_call 3 280 "$display", "================== INFERENCE RUN 2 ==================" {0 0 0};
    %pushi/vec4 4, 0, 4;
    %store/vec4 v000001fa49c8c760_0, 0, 4;
    %pushi/vec4 1, 0, 3;
    %store/vec4 v000001fa49c8b860_0, 0, 3;
    %fork TD_gpt2_demo_tb.run_inference, S_000001fa49b259f0;
    %join;
    %delay 100000, 0;
    %vpi_call 3 285 "$display", "================== INFERENCE RUN 3 ==================" {0 0 0};
    %pushi/vec4 1, 0, 4;
    %store/vec4 v000001fa49c8c760_0, 0, 4;
    %pushi/vec4 2, 0, 3;
    %store/vec4 v000001fa49c8b860_0, 0, 3;
    %fork TD_gpt2_demo_tb.run_inference, S_000001fa49b259f0;
    %join;
    %delay 100000, 0;
    %vpi_call 3 290 "$display", "\000" {0 0 0};
    %vpi_call 3 291 "$display", "================================================================" {0 0 0};
    %vpi_call 3 292 "$display", "  DEMO COMPLETE \342\200\224 BitbyBit GPU Operational!" {0 0 0};
    %vpi_call 3 293 "$display", "  Architecture: 16 modules | 4 layers | Q8.8 fixed-point" {0 0 0};
    %vpi_call 3 294 "$display", "  Optimizations: Zero-skip | Sparse CSR | INT4 quantization" {0 0 0};
    %vpi_call 3 295 "$display", "================================================================" {0 0 0};
    %vpi_call 3 296 "$display", "\000" {0 0 0};
    %vpi_call 3 297 "$finish" {0 0 0};
    %end;
    .thread T_24;
    .scope S_000001fa49c13150;
T_25 ;
    %wait E_000001fa49c2cc40;
    %load/vec4 v000001fa49ca0520_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_25.0, 8;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49ca0480_0, 0, 32;
T_25.2 ;
    %load/vec4 v000001fa49ca0480_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_25.3, 5;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49ca0ac0_0, 0, 32;
T_25.4 ;
    %load/vec4 v000001fa49ca0ac0_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_25.5, 5;
    %pushi/vec4 0, 0, 16;
    %load/vec4 v000001fa49ca0480_0;
    %pad/s 35;
    %pad/s 37;
    %muli 4, 0, 37;
    %pad/s 38;
    %load/vec4 v000001fa49ca0ac0_0;
    %pad/s 38;
    %add;
    %ix/vec4/s 3;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49ca0b60, 0, 4;
    %load/vec4 v000001fa49ca0ac0_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49ca0ac0_0, 0, 32;
    %jmp T_25.4;
T_25.5 ;
    %load/vec4 v000001fa49ca0480_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49ca0480_0, 0, 32;
    %jmp T_25.2;
T_25.3 ;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49ca0ac0_0, 0, 32;
T_25.6 ;
    %load/vec4 v000001fa49ca0ac0_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_25.7, 5;
    %pushi/vec4 0, 0, 16;
    %ix/getv/s 3, v000001fa49ca0ac0_0;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49ca1b00, 0, 4;
    %load/vec4 v000001fa49ca0ac0_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49ca0ac0_0, 0, 32;
    %jmp T_25.6;
T_25.7 ;
    %jmp T_25.1;
T_25.0 ;
    %load/vec4 v000001fa49ca0340_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_25.8, 8;
    %load/vec4 v000001fa49ca08e0_0;
    %load/vec4 v000001fa49ca0a20_0;
    %pad/u 7;
    %pad/u 9;
    %muli 4, 0, 9;
    %pad/u 10;
    %load/vec4 v000001fa49ca0700_0;
    %pad/u 4;
    %pad/u 10;
    %add;
    %ix/vec4 3;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49ca0b60, 0, 4;
T_25.8 ;
    %load/vec4 v000001fa49ca1420_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_25.10, 8;
    %load/vec4 v000001fa49ca1a60_0;
    %load/vec4 v000001fa49ca02a0_0;
    %pad/u 4;
    %ix/vec4 3;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49ca1b00, 0, 4;
T_25.10 ;
T_25.1 ;
    %jmp T_25;
    .thread T_25;
    .scope S_000001fa49c13150;
T_26 ;
    %wait E_000001fa49c2cc40;
    %load/vec4 v000001fa49ca0520_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_26.0, 8;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49ca1ba0_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49ca0660_0, 0;
    %pushi/vec4 0, 0, 3;
    %assign/vec4 v000001fa49ca03e0_0, 0;
    %pushi/vec4 0, 0, 64;
    %assign/vec4 v000001fa49ca0de0_0, 0;
    %jmp T_26.1;
T_26.0 ;
    %load/vec4 v000001fa49ca1ba0_0;
    %dup/vec4;
    %pushi/vec4 0, 0, 4;
    %cmp/u;
    %jmp/1 T_26.2, 6;
    %dup/vec4;
    %pushi/vec4 1, 0, 4;
    %cmp/u;
    %jmp/1 T_26.3, 6;
    %dup/vec4;
    %pushi/vec4 2, 0, 4;
    %cmp/u;
    %jmp/1 T_26.4, 6;
    %jmp T_26.5;
T_26.2 ;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49ca0660_0, 0;
    %load/vec4 v000001fa49ca05c0_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_26.6, 8;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49ca0480_0, 0, 32;
T_26.8 ;
    %load/vec4 v000001fa49ca0480_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_26.9, 5;
    %load/vec4 v000001fa49ca0c00_0;
    %load/vec4 v000001fa49ca0480_0;
    %muli 16, 0, 32;
    %part/s 16;
    %ix/getv/s 3, v000001fa49ca0480_0;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49ca14c0, 0, 4;
    %load/vec4 v000001fa49ca0480_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49ca0480_0, 0, 32;
    %jmp T_26.8;
T_26.9 ;
    %pushi/vec4 0, 0, 3;
    %assign/vec4 v000001fa49ca03e0_0, 0;
    %pushi/vec4 1, 0, 4;
    %assign/vec4 v000001fa49ca1ba0_0, 0;
T_26.6 ;
    %jmp T_26.5;
T_26.3 ;
    %load/vec4 v000001fa49ca03e0_0;
    %pad/u 32;
    %cmpi/u 4, 0, 32;
    %jmp/0xz  T_26.10, 5;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49ca0ca0_0, 0, 32;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49ca0480_0, 0, 32;
T_26.12 ;
    %load/vec4 v000001fa49ca0480_0;
    %cmpi/s 4, 0, 32;
    %jmp/0xz T_26.13, 5;
    %ix/getv/s 4, v000001fa49ca0480_0;
    %load/vec4a v000001fa49ca14c0, 4;
    %pad/s 32;
    %cmpi/ne 0, 0, 32;
    %flag_get/vec4 4;
    %jmp/0 T_26.16, 4;
    %load/vec4 v000001fa49ca0480_0;
    %pad/s 35;
    %pad/s 37;
    %muli 4, 0, 37;
    %pad/s 38;
    %load/vec4 v000001fa49ca03e0_0;
    %pad/u 4;
    %pad/u 38;
    %add;
    %ix/vec4 4;
    %load/vec4a v000001fa49ca0b60, 4;
    %pad/s 32;
    %pushi/vec4 0, 0, 32;
    %cmp/ne;
    %flag_get/vec4 4;
    %and;
T_26.16;
    %flag_set/vec4 8;
    %jmp/0xz  T_26.14, 8;
    %ix/getv/s 4, v000001fa49ca0480_0;
    %load/vec4a v000001fa49ca14c0, 4;
    %pad/s 32;
    %load/vec4 v000001fa49ca0480_0;
    %pad/s 35;
    %pad/s 37;
    %muli 4, 0, 37;
    %pad/s 38;
    %load/vec4 v000001fa49ca03e0_0;
    %pad/u 4;
    %pad/u 38;
    %add;
    %ix/vec4 4;
    %load/vec4a v000001fa49ca0b60, 4;
    %pad/s 32;
    %mul;
    %store/vec4 v000001fa49ca0d40_0, 0, 32;
    %load/vec4 v000001fa49ca0ca0_0;
    %load/vec4 v000001fa49ca0d40_0;
    %parti/s 1, 31, 6;
    %pop/vec4 1; skip zero replication
    %load/vec4 v000001fa49ca0d40_0;
    %add;
    %store/vec4 v000001fa49ca0ca0_0, 0, 32;
T_26.14 ;
    %load/vec4 v000001fa49ca0480_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49ca0480_0, 0, 32;
    %jmp T_26.12;
T_26.13 ;
    %load/vec4 v000001fa49ca0ca0_0;
    %parti/s 16, 8, 5;
    %load/vec4 v000001fa49ca03e0_0;
    %pad/u 4;
    %ix/vec4 4;
    %load/vec4a v000001fa49ca1b00, 4;
    %add;
    %ix/load 5, 0, 0;
    %load/vec4 v000001fa49ca03e0_0;
    %pad/u 32;
    %muli 16, 0, 32;
    %ix/vec4 4;
    %assign/vec4/off/d v000001fa49ca0de0_0, 4, 5;
    %load/vec4 v000001fa49ca03e0_0;
    %addi 1, 0, 3;
    %assign/vec4 v000001fa49ca03e0_0, 0;
    %jmp T_26.11;
T_26.10 ;
    %pushi/vec4 2, 0, 4;
    %assign/vec4 v000001fa49ca1ba0_0, 0;
T_26.11 ;
    %jmp T_26.5;
T_26.4 ;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v000001fa49ca0660_0, 0;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49ca1ba0_0, 0;
    %jmp T_26.5;
T_26.5 ;
    %pop/vec4 1;
T_26.1 ;
    %jmp T_26;
    .thread T_26;
    .scope S_000001fa49abe430;
T_27 ;
    %wait E_000001fa49c2ccc0;
    %load/vec4 v000001fa49ca3110_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_27.0, 8;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49ca36b0_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49ca3c50_0, 0;
    %pushi/vec4 0, 0, 16;
    %assign/vec4 v000001fa49ca2cb0_0, 0;
    %pushi/vec4 0, 0, 16;
    %assign/vec4 v000001fa49ca32f0_0, 0;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49ca2df0_0, 0;
    %pushi/vec4 0, 0, 64;
    %assign/vec4 v000001fa49ca3d90_0, 0;
    %jmp T_27.1;
T_27.0 ;
    %load/vec4 v000001fa49ca36b0_0;
    %dup/vec4;
    %pushi/vec4 0, 0, 4;
    %cmp/u;
    %jmp/1 T_27.2, 6;
    %dup/vec4;
    %pushi/vec4 1, 0, 4;
    %cmp/u;
    %jmp/1 T_27.3, 6;
    %dup/vec4;
    %pushi/vec4 2, 0, 4;
    %cmp/u;
    %jmp/1 T_27.4, 6;
    %dup/vec4;
    %pushi/vec4 3, 0, 4;
    %cmp/u;
    %jmp/1 T_27.5, 6;
    %dup/vec4;
    %pushi/vec4 4, 0, 4;
    %cmp/u;
    %jmp/1 T_27.6, 6;
    %jmp T_27.7;
T_27.2 ;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v000001fa49ca3c50_0, 0;
    %load/vec4 v000001fa49ca3610_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_27.8, 8;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v000001fa49ca2b70_0, 0, 32;
T_27.10 ;
    %load/vec4 v000001fa49ca2b70_0;
    %cmpi/s 8, 0, 32;
    %jmp/0xz T_27.11, 5;
    %load/vec4 v000001fa49ca2fd0_0;
    %load/vec4 v000001fa49ca2b70_0;
    %muli 16, 0, 32;
    %part/s 16;
    %ix/getv/s 3, v000001fa49ca2b70_0;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49ca22b0, 0, 4;
    %load/vec4 v000001fa49ca2b70_0;
    %addi 1, 0, 32;
    %store/vec4 v000001fa49ca2b70_0, 0, 32;
    %jmp T_27.10;
T_27.11 ;
    %load/vec4 v000001fa49ca2fd0_0;
    %parti/s 16, 0, 2;
    %assign/vec4 v000001fa49ca2cb0_0, 0;
    %pushi/vec4 1, 0, 4;
    %assign/vec4 v000001fa49ca2df0_0, 0;
    %pushi/vec4 1, 0, 4;
    %assign/vec4 v000001fa49ca36b0_0, 0;
T_27.8 ;
    %jmp T_27.7;
T_27.3 ;
    %load/vec4 v000001fa49ca2df0_0;
    %pad/u 32;
    %cmpi/u 8, 0, 32;
    %jmp/0xz  T_27.12, 5;
    %load/vec4 v000001fa49ca2cb0_0;
    %load/vec4 v000001fa49ca2df0_0;
    %pad/u 5;
    %ix/vec4 4;
    %load/vec4a v000001fa49ca22b0, 4;
    %cmp/s;
    %jmp/0xz  T_27.14, 5;
    %load/vec4 v000001fa49ca2df0_0;
    %pad/u 5;
    %ix/vec4 4;
    %load/vec4a v000001fa49ca22b0, 4;
    %assign/vec4 v000001fa49ca2cb0_0, 0;
T_27.14 ;
    %load/vec4 v000001fa49ca2df0_0;
    %addi 1, 0, 4;
    %assign/vec4 v000001fa49ca2df0_0, 0;
    %jmp T_27.13;
T_27.12 ;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49ca2df0_0, 0;
    %pushi/vec4 0, 0, 16;
    %assign/vec4 v000001fa49ca32f0_0, 0;
    %pushi/vec4 2, 0, 4;
    %assign/vec4 v000001fa49ca36b0_0, 0;
T_27.13 ;
    %jmp T_27.7;
T_27.4 ;
    %load/vec4 v000001fa49ca2df0_0;
    %pad/u 32;
    %cmpi/u 8, 0, 32;
    %jmp/0xz  T_27.16, 5;
    %load/vec4 v000001fa49ca2df0_0;
    %pad/u 5;
    %ix/vec4 4;
    %load/vec4a v000001fa49ca22b0, 4;
    %load/vec4 v000001fa49ca2cb0_0;
    %sub;
    %store/vec4 v000001fa49ca39d0_0, 0, 16;
    %load/vec4 v000001fa49ca39d0_0;
    %store/vec4 v000001fa49ca1560_0, 0, 16;
    %callf/vec4 TD_softmax_unit.exp_approx, S_000001fa49c8d320;
    %load/vec4 v000001fa49ca2df0_0;
    %pad/u 5;
    %ix/vec4 3;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v000001fa49ca2c10, 0, 4;
    %load/vec4 v000001fa49ca32f0_0;
    %pushi/vec4 0, 0, 8;
    %load/vec4 v000001fa49ca39d0_0;
    %store/vec4 v000001fa49ca1560_0, 0, 16;
    %callf/vec4 TD_softmax_unit.exp_approx, S_000001fa49c8d320;
    %concat/vec4; draw_concat_vec4
    %add;
    %assign/vec4 v000001fa49ca32f0_0, 0;
    %load/vec4 v000001fa49ca2df0_0;
    %addi 1, 0, 4;
    %assign/vec4 v000001fa49ca2df0_0, 0;
    %jmp T_27.17;
T_27.16 ;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49ca2df0_0, 0;
    %pushi/vec4 3, 0, 4;
    %assign/vec4 v000001fa49ca36b0_0, 0;
T_27.17 ;
    %jmp T_27.7;
T_27.5 ;
    %load/vec4 v000001fa49ca2df0_0;
    %pad/u 32;
    %cmpi/u 8, 0, 32;
    %jmp/0xz  T_27.18, 5;
    %load/vec4 v000001fa49ca32f0_0;
    %pad/u 32;
    %cmpi/u 0, 0, 32;
    %flag_or 5, 4; GT is !LE
    %flag_inv 5;
    %jmp/0xz  T_27.20, 5;
    %pushi/vec4 0, 0, 8;
    %load/vec4 v000001fa49ca2df0_0;
    %pad/u 5;
    %ix/vec4 4;
    %load/vec4a v000001fa49ca2c10, 4;
    %concat/vec4; draw_concat_vec4
    %muli 256, 0, 16;
    %load/vec4 v000001fa49ca32f0_0;
    %div;
    %store/vec4 v000001fa49ca2d50_0, 0, 16;
    %jmp T_27.21;
T_27.20 ;
    %pushi/vec4 0, 0, 16;
    %store/vec4 v000001fa49ca2d50_0, 0, 16;
T_27.21 ;
    %load/vec4 v000001fa49ca2d50_0;
    %parti/s 8, 0, 2;
    %ix/load 5, 0, 0;
    %load/vec4 v000001fa49ca2df0_0;
    %pad/u 32;
    %muli 8, 0, 32;
    %ix/vec4 4;
    %assign/vec4/off/d v000001fa49ca3d90_0, 4, 5;
    %load/vec4 v000001fa49ca2df0_0;
    %addi 1, 0, 4;
    %assign/vec4 v000001fa49ca2df0_0, 0;
    %jmp T_27.19;
T_27.18 ;
    %pushi/vec4 4, 0, 4;
    %assign/vec4 v000001fa49ca36b0_0, 0;
T_27.19 ;
    %jmp T_27.7;
T_27.6 ;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v000001fa49ca3c50_0, 0;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v000001fa49ca36b0_0, 0;
    %jmp T_27.7;
T_27.7 ;
    %pop/vec4 1;
T_27.1 ;
    %jmp T_27;
    .thread T_27;
# The file index is used to find the file name in the following table.
:file_names 12;
    "N/A";
    "<interactive>";
    "rtl/compute/gelu_activation.v";
    "tb/demo/gpt2_demo_tb.v";
    "rtl/gpt2/gpt2_engine.v";
    "rtl/gpt2/transformer_block.v";
    "rtl/transformer/attention_unit.v";
    "rtl/transformer/ffn_block.v";
    "rtl/transformer/layer_norm.v";
    "rtl/gpt2/embedding_lookup.v";
    "rtl/transformer/linear_layer.v";
    "rtl/compute/softmax_unit.v";
